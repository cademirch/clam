{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"clam","text":"<p>clam identifies genomic regions with sufficient sequencing depth to be considered \"callable\" and uses this information to calculate population genetic statistics from VCFs. It eliminates the need to generate all-sites VCF files while still producing accurate diversity estimates.</p> <p>clam was designed specifically for large population genomics datasets.</p>"},{"location":"#installation","title":"Installation","text":"<p>From bioconda:</p> <pre><code>conda create -n clam bioconda::clam\n</code></pre> <p>From source:</p> <pre><code>git clone https://github.com/cademirch/clam.git\ncd clam\ncargo build --release\n./target/release/clam --help\n</code></pre>"},{"location":"#quick-start","title":"Quick Start","text":""},{"location":"#1-generate-callable-loci-from-depth-data","title":"1. Generate callable loci from depth data","text":"<pre><code>clam loci -o callable.zarr -m 10 -t 8 *.d4.gz\n</code></pre>"},{"location":"#2-calculate-population-genetic-statistics","title":"2. Calculate population genetic statistics","text":"<pre><code>clam stat -o results/ -w 10000 -c callable.zarr variants.vcf.gz\n</code></pre>"},{"location":"#commands","title":"Commands","text":"<p>clam has three main commands:</p> Command Description <code>loci</code> Generate callable loci from depth files (D4, GVCF) <code>stat</code> Calculate \u03c0, d<sub>xy</sub>, F<sub>ST</sub>, and heterozygosity from VCF using callable sites <code>collect</code> Pre-process depth files into Zarr for repeated use"},{"location":"#citation","title":"Citation","text":"<p>If you use clam in your research, please cite:</p> <p>Mirchandani C, Enbody E, Sackton TB, Corbett-Detig R. Efficient estimation of nucleotide diversity and divergence using callable loci (and more). Mol Biol Evol. 2025;msaf282. doi:10.1093/molbev/msaf282</p> <pre><code>@article{Mirchandani2025-hx,\n  title     = {Efficient estimation of nucleotide diversity and divergence using\n               callable loci (and more)},\n  author    = {Mirchandani, Cade and Enbody, Erik and Sackton, Timothy B and\n               Corbett-Detig, Russ},\n  journal   = {Mol. Biol. Evol.},\n  publisher = {Oxford University Press (OUP)},\n  number    = {msaf282},\n  month     = nov,\n  year      = 2025,\n  language  = {en}\n}\n</code></pre>"},{"location":"#license","title":"License","text":"<p>clam is distributed under the terms of the MIT license.</p>"},{"location":"explanation/concepts/","title":"Core Concepts","text":"<p>This page explains the key concepts behind clam and how they relate to population genetics analysis.</p>"},{"location":"explanation/concepts/#callable-loci","title":"Callable Loci","text":"<p>A genomic site is considered callable for a sample if we have sufficient confidence that we could accurately determine the genotype at that position. In practice, this means the site has adequate sequencing depth.</p> <p>Sites that are not callable include:</p> <ul> <li>Regions with no coverage (unmapped reads)</li> <li>Regions with very low coverage (unreliable genotype calls)</li> <li>Regions with extremely high coverage (often repetitive elements or CNVs)</li> </ul> <p>clam tracks callable sites at two levels:</p> <ol> <li>Sample-level: Is this site callable for a specific individual?</li> <li>Site-level: Is this site callable for the analysis (e.g., callable in enough samples)?</li> </ol>"},{"location":"explanation/concepts/#depth-thresholds","title":"Depth Thresholds","text":"<p>clam uses depth thresholds to determine callability. Both minimum and maximum thresholds are important:</p>"},{"location":"explanation/concepts/#minimum-depth","title":"Minimum Depth","text":"<p>Sites with very low depth have unreliable genotype calls. A heterozygous site with only 2x coverage has a 50% chance of appearing homozygous simply due to sampling.</p> <p>Common minimum thresholds range from 5x to 15x depending on your confidence requirements and ploidy.</p>"},{"location":"explanation/concepts/#maximum-depth","title":"Maximum Depth","text":"<p>Extremely high depth often indicates:</p> <ul> <li>Repetitive regions where reads from multiple genomic locations map to the same place</li> <li>Copy number variants (CNVs) or duplications</li> <li>Systematic mapping artifacts</li> </ul> <p>These regions tend to have unreliable variant calls and are typically excluded. Maximum thresholds are often set to 2-3x the mean genome-wide depth.</p>"},{"location":"explanation/concepts/#per-chromosome-thresholds","title":"Per-Chromosome Thresholds","text":"<p>Some chromosomes may require different thresholds:</p> <ul> <li>Sex chromosomes in samples with XY sex determination have half the expected autosomal depth</li> <li>Organellar genomes (mitochondria, chloroplasts) often have much higher depth</li> </ul> <p>clam supports per-chromosome threshold files to handle these cases.</p>"},{"location":"explanation/concepts/#sample-level-vs-site-level-filtering","title":"Sample-Level vs Site-Level Filtering","text":"<p>clam applies thresholds in two stages:</p>"},{"location":"explanation/concepts/#sample-level-thresholds","title":"Sample-Level Thresholds","text":"<p>First, for each sample at each position, clam checks if the depth falls within the acceptable range:</p> <pre><code>min_depth &lt;= sample_depth &lt;= max_depth\n</code></pre> <p>If yes, that site is callable for that sample.</p>"},{"location":"explanation/concepts/#site-level-thresholds","title":"Site-Level Thresholds","text":"<p>Next, clam can apply aggregate filters across all samples:</p> <ul> <li>Proportion callable (<code>-d</code>): What fraction of samples must be callable? Setting <code>-d 0.8</code> requires 80% of samples to pass individual thresholds.</li> <li>Mean depth range (<code>--min-mean-depth</code>, <code>--max-mean-depth</code>): What is the acceptable range for mean depth across all samples at a site?</li> </ul> <p>These filters help identify sites that are systematically problematic across the dataset.</p>"},{"location":"explanation/concepts/#populations","title":"Populations","text":"<p>Many population genetic statistics compare diversity within and between groups:</p> <ul> <li>\u03c0 (pi): Nucleotide diversity within a population</li> <li>d<sub>xy</sub>: Absolute divergence between two populations  </li> <li>F<sub>ST</sub>: Relative differentiation between populations</li> </ul> <p>To calculate these statistics, clam needs to know which samples belong to which population. You can specify populations using <code>--samples</code> (recommended) or <code>--population-file</code> (deprecated), or let clam read them automatically from zarr metadata.</p> <p>When populations are defined:</p> <ul> <li><code>clam collect</code> stores population metadata in the output zarr</li> <li><code>clam loci</code> tracks callable sites per population (how many samples in each population are callable at each site) and stores population metadata in the output zarr</li> <li><code>clam stat</code> reads population metadata from the callable zarr automatically, or you can override with <code>--samples</code> or <code>-p</code></li> </ul> <p>This means populations only need to be specified once -- typically during <code>clam collect</code> or <code>clam loci</code> -- and flow through the pipeline via zarr metadata.</p> <p>Without population assignments at any stage, clam treats all samples as a single population and only calculates \u03c0.</p>"},{"location":"explanation/concepts/#the-clam-workflow","title":"The clam Workflow","text":"<p>A typical clam analysis has two main steps:</p>"},{"location":"explanation/concepts/#step-1-generate-callable-loci-clam-loci","title":"Step 1: Generate Callable Loci (<code>clam loci</code>)","text":"<pre><code>Depth files (D4/GVCF) \u2192 clam loci \u2192 Callable loci (Zarr)\n</code></pre> <p>This step processes depth information and applies your thresholds to determine which sites are callable. The output is a compact Zarr array storing callable counts per population at each genomic position, along with population metadata that downstream commands can read automatically.</p>"},{"location":"explanation/concepts/#step-2-calculate-statistics-clam-stat","title":"Step 2: Calculate Statistics (<code>clam stat</code>)","text":"<pre><code>Callable loci (Zarr) + Variants (VCF) \u2192 clam stat \u2192 Statistics (TSV)\n</code></pre> <p>This step combines callable site information with variant calls to compute accurate diversity statistics. The callable loci provide the denominator (total comparisons), while the VCF provides the numerator (differences).</p>"},{"location":"explanation/concepts/#optional-pre-collect-depth-clam-collect","title":"Optional: Pre-collect Depth (<code>clam collect</code>)","text":"<p>For workflows where you want to run <code>loci</code> multiple times with different thresholds:</p> <pre><code>Depth files (D4/GVCF) \u2192 clam collect \u2192 Depth (Zarr) \u2192 clam loci \u2192 Callable loci (Zarr)\n</code></pre> <p>The <code>collect</code> step stores raw depth values in an efficient Zarr format. This is faster than re-reading the original depth files when testing multiple threshold configurations.</p> <p>Population assignments are preserved through this pipeline -- if you specify populations during <code>collect</code> or <code>loci</code>, they are stored in the Zarr metadata and automatically used by downstream commands.</p>"},{"location":"explanation/concepts/#statistics-calculated","title":"Statistics Calculated","text":"<p>clam calculates the following statistics in windows across the genome:</p>"},{"location":"explanation/concepts/#nucleotide-diversity","title":"Nucleotide Diversity (\u03c0)","text":"<p>The average number of pairwise differences per site within a population:</p> \\[\\pi = \\frac{\\sum \\text{pairwise differences}}{\\sum \\text{pairwise comparisons}}\\]"},{"location":"explanation/concepts/#absolute-divergence-dxy","title":"Absolute Divergence (d<sub>xy</sub>)","text":"<p>The average number of pairwise differences per site between two populations:</p> \\[d_{xy} = \\frac{\\sum \\text{between-population differences}}{\\sum \\text{between-population comparisons}}\\]"},{"location":"explanation/concepts/#fixation-index-fst","title":"Fixation Index (F<sub>ST</sub>)","text":"<p>A measure of population differentiation, calculated using the Hudson estimator:</p> \\[F_{ST} = \\frac{d_{xy} - \\frac{\\pi_1 + \\pi_2}{2}}{d_{xy}}\\] <p>clam uses a ratio-of-averages approach, summing numerators and denominators across sites within each window before computing the final ratio.</p>"},{"location":"explanation/concepts/#runs-of-homozygosity-roh","title":"Runs of Homozygosity (ROH)","text":"<p>In populations with recent inbreeding or small effective population size, individuals may have long runs of homozygosity (ROH). When calculating diversity statistics, it can be useful to exclude samples that are within ROH regions at each site.</p> <p>Non-ROH heterozygosity can serve as a proxy for the inbreeding load in a population. This is because deleterious mutations that were previously masked as heterozygotes become exposed in ROH regions, and the abundance of such mutations scales with genetic diversity (Kyriazis et al. 2025).</p> <p>clam can optionally accept ROH intervals (<code>--roh</code>) and will calculate heterozygosity excluding samples in ROH regions. At each site, any sample falling within an ROH region is excluded from the heterozygosity calculation for that site.</p>"},{"location":"explanation/concepts/#heterozygosity","title":"Heterozygosity","text":"<p>Heterozygosity is the proportion of heterozygous sites among callable sites:</p> \\[H = \\frac{n_{\\text{het}}}{n_{\\text{callable}}}\\] <p>Where:</p> <ul> <li>\\(n_{\\text{het}}\\) is the number of heterozygous genotypes</li> <li>\\(n_{\\text{callable}}\\) is the number of callable sites</li> </ul> <p>When callable sites are provided, clam outputs a <code>heterozygosity.tsv</code> file with heterozygosity estimates per window.</p>"},{"location":"explanation/concepts/#per-sample-mode","title":"Per-Sample Mode","text":"<p>When using per-sample callable masks (<code>--per-sample</code> in <code>clam loci</code>), heterozygosity is calculated for each sample individually. This provides the most accurate estimates because each sample has its own callable site mask.</p> <p>For each sample in each window:</p> <ul> <li><code>het_total</code>: Number of heterozygous genotypes for the sample</li> <li><code>callable_total</code>: Number of sites where the sample is callable</li> <li><code>heterozygosity</code>: <code>het_total / callable_total</code></li> </ul>"},{"location":"explanation/concepts/#per-population-mode","title":"Per-Population Mode","text":"<p>When using population-level callable counts (default <code>clam loci</code> output), heterozygosity is calculated per population by summing across all samples in the population.</p> <p>For each population in each window:</p> <ul> <li><code>het_total</code>: Sum of heterozygous genotypes across all samples in the population</li> <li><code>callable_total</code>: Sum of callable sites across all samples in the population</li> <li><code>heterozygosity</code>: <code>het_total / callable_total</code></li> </ul> <p>Note</p> <p>Per-population heterozygosity with ROH exclusion is approximate because the callable counts are aggregated at the population level. For accurate per-sample ROH exclusion, use per-sample callable masks.</p>"},{"location":"explanation/concepts/#roh-excluded-heterozygosity","title":"ROH-Excluded Heterozygosity","text":"<p>When ROH data is provided, clam also calculates heterozygosity after excluding samples in ROH regions:</p> <ul> <li><code>het_not_in_roh</code>: Heterozygous sites where the sample is not in an ROH region</li> <li><code>callable_not_in_roh</code>: Callable sites where the sample is not in an ROH region</li> <li><code>heterozygosity_not_in_roh</code>: <code>het_not_in_roh / callable_not_in_roh</code></li> </ul>"},{"location":"explanation/why-clam/","title":"Why clam?","text":"<p>Accurate estimation of population genetic statistics like nucleotide diversity (\u03c0), divergence (d<sub>xy</sub>), and F<sub>ST</sub> requires knowing which sites in the genome were actually assayed. For example, \u03c0 is calculated as:</p> \\[\\pi = \\frac{\\text{number of pairwise differences}}{\\text{number of pairwise comparisons}}\\] <p>The denominator requires knowing how many sites were successfully genotyped. Getting this wrong leads to biased estimates.</p>"},{"location":"explanation/why-clam/#the-problem-with-variants-only-vcfs","title":"The Problem with Variants-Only VCFs","text":"<p>Standard VCF files only record positions where at least one sample differs from the reference. They don't record genotypes at invariant sites, which creates a problem: you can't distinguish between \"this site is reference in all samples\" and \"this site has no data.\"</p> <p>Consider a position where:</p> <ul> <li>Sample A has 30x coverage and is homozygous reference</li> <li>Sample B has 0x coverage (no data)</li> </ul> <p>In a variants-only VCF, neither sample appears at this position. But when calculating diversity, these situations are different:</p> <ul> <li>Sample A should contribute to the denominator (it's a valid comparison)</li> <li>Sample B should not (we don't know what allele it has)</li> </ul> <p>Many tools assume that sites absent from the VCF are homozygous reference, leading to systematic underestimation of diversity statistics (Korunes and Samuk 2021). The estimators themselves aren't statistically biased; the apparent bias arises from mismeasurement of the denominator when incorrect assumptions about unobserved sites result in erroneous counts of total base pairs assayed.</p>"},{"location":"explanation/why-clam/#why-all-sites-vcfs-dont-scale","title":"Why All-Sites VCFs Don't Scale","text":"<p>One solution is to generate an \"all-sites\" VCF that includes both variant and invariant positions. This correctly records which sites were successfully genotyped across samples, allowing proper enumeration of the denominator.</p> <p>However, all-sites VCFs become impractical as datasets grow. For large population genomics projects with hundreds or thousands of samples, they pose computational challenges in creation, storage, and analysis. Additionally, filtering approaches for all-sites VCFs often differ from those applied to variants-only VCFs, introducing potentially unaccounted for confounding effects.</p>"},{"location":"explanation/why-clam/#clams-approach-callable-loci","title":"clam's Approach: Callable Loci","text":"<p>clam uses callable loci\u2014determined from sequencing depth\u2014to estimate population genetic statistics from a variants-only VCF. The key insight is that for calculating diversity statistics, you don't need the actual genotype at invariant sites. You only need to know:</p> <ol> <li>At variant sites: What are the allele counts?</li> <li>At invariant sites: How many samples had sufficient coverage to call a genotype?</li> </ol> <p>The workflow has two steps:</p> <ol> <li> <p><code>clam loci</code>: Process depth information (from D4 files or GVCFs) to identify which sites are \"callable\" for each sample or population. A site is callable if it has sufficient sequencing depth to reliably call a genotype.</p> </li> <li> <p><code>clam stat</code>: Combine the callable site information with a variants-only VCF to calculate population genetic statistics.</p> </li> </ol> <p>By tracking callable sites separately, clam computes the correct denominator without storing genotypes at millions of invariant positions. The numerator comes from variant sites in the VCF; the denominator comes from both variant sites and callable invariant sites.</p>"},{"location":"explanation/why-clam/#when-to-use-clam","title":"When to Use clam","text":"<p>clam is useful when:</p> <ul> <li>You have many samples (tens to thousands)</li> <li>Your genome is large</li> <li>You have variable coverage across samples</li> <li>You want to run multiple analyses with different filtering criteria</li> <li>Storage or compute resources are limited</li> </ul> <p>If you have a small dataset where all-sites VCFs are practical, you may not need clam. But for large-scale population genomics, clam provides a scalable path to accurate diversity estimates.</p>"},{"location":"how-to/calculate-statistics/","title":"Calculate Statistics","text":"<p>This guide covers how to use <code>clam stat</code> to calculate population genetic statistics from a VCF using callable site information.</p>"},{"location":"how-to/calculate-statistics/#prerequisites","title":"Prerequisites","text":"<ul> <li>A VCF file (bgzipped and tabix indexed)</li> <li>Callable loci Zarr from <code>clam loci</code> (recommended)</li> <li>Optional: population file or <code>--samples</code> TSV for d<sub>xy</sub> and F<sub>ST</sub> (not needed if callable zarr already contains population metadata)</li> <li>Optional: ROH file for calculating non-ROH heterozygosity</li> </ul>"},{"location":"how-to/calculate-statistics/#input-requirements","title":"Input Requirements","text":""},{"location":"how-to/calculate-statistics/#vcf-file","title":"VCF File","text":"<p>The input VCF must be bgzipped and tabix indexed:</p> <pre><code>bgzip variants.vcf\ntabix -p vcf variants.vcf.gz\n</code></pre>"},{"location":"how-to/calculate-statistics/#callable-sites","title":"Callable Sites","text":"<p>While optional, providing callable sites from <code>clam loci</code> is strongly recommended for accurate statistics:</p> <pre><code>clam stat -o results/ -w 10000 -c callable.zarr variants.vcf.gz\n</code></pre> <p>Without callable sites, all positions in the VCF are assumed callable, which can bias diversity estimates if you have missing data.</p>"},{"location":"how-to/calculate-statistics/#basic-usage","title":"Basic Usage","text":""},{"location":"how-to/calculate-statistics/#fixed-size-windows","title":"Fixed-Size Windows","text":"<p>Calculate statistics in fixed-size windows across the genome:</p> <pre><code>clam stat -o results/ -w 10000 -c callable.zarr variants.vcf.gz\n</code></pre> <p>This calculates \u03c0 (and d<sub>xy</sub>, F<sub>ST</sub> if populations are defined) in 10kb windows.</p>"},{"location":"how-to/calculate-statistics/#custom-regions","title":"Custom Regions","text":"<p>Calculate statistics for specific regions defined in a BED file:</p> <pre><code>clam stat -o results/ --regions-file genes.bed -c callable.zarr variants.vcf.gz\n</code></pre>"},{"location":"how-to/calculate-statistics/#specifying-populations","title":"Specifying Populations","text":"<p>To calculate between-population statistics (d<sub>xy</sub> and F<sub>ST</sub>), clam needs population assignments. There are three ways to provide them:</p>"},{"location":"how-to/calculate-statistics/#automatic-from-callable-zarr-recommended","title":"Automatic from Callable Zarr (Recommended)","text":"<p>If populations were defined during the <code>clam loci</code> step, they are stored in the callable Zarr metadata. <code>clam stat</code> reads them automatically -- no extra flags needed:</p> <pre><code>clam stat -o results/ -w 10000 -c callable.zarr variants.vcf.gz\n</code></pre> <p>This produces <code>dxy.tsv</code> and <code>fst.tsv</code> automatically when the callable zarr contains multiple populations.</p>"},{"location":"how-to/calculate-statistics/#using-samples","title":"Using --samples","text":"<p>Provide a samples TSV to define (or override) population assignments:</p> <pre><code>clam stat -o results/ -w 10000 -c callable.zarr -s samples.tsv variants.vcf.gz\n</code></pre> <p>Only the <code>sample_name</code> and <code>population</code> columns are used; <code>file_path</code> is ignored for <code>clam stat</code>.</p>"},{"location":"how-to/calculate-statistics/#using-population-file-deprecated","title":"Using --population-file (Deprecated)","text":"<pre><code>clam stat -o results/ -w 10000 -c callable.zarr -p populations.tsv variants.vcf.gz\n</code></pre> <p>The population file maps samples to populations:</p> <pre><code>sample1 PopA\nsample2 PopA\nsample3 PopB\nsample4 PopB\n</code></pre> <p>Population Consistency</p> <p>When using <code>--samples</code> or <code>--population-file</code> with a callable Zarr that has <code>PopulationCounts</code> type, the number of populations must match the number of population columns in the Zarr. If they don't match, clam will produce a clear error. Use callable sites generated with <code>--per-sample</code> mode for maximum flexibility with different population definitions at stat time.</p> <p>Sample Names</p> <p>Sample names must exactly match those in your VCF header.</p>"},{"location":"how-to/calculate-statistics/#handling-missing-samples","title":"Handling Missing Samples","text":"<p>By default, clam errors if the VCF contains samples not in the population file. To instead warn and exclude those samples:</p> <pre><code>clam stat -o results/ -w 10000 -c callable.zarr -p populations.tsv --force-samples variants.vcf.gz\n</code></pre>"},{"location":"how-to/calculate-statistics/#using-roh-data","title":"Using ROH Data","text":"<p>If you have runs of homozygosity (ROH) calls, clam can calculate non-ROH heterozygosity by excluding samples within ROH regions at each site:</p> <pre><code>clam stat -o results/ -w 10000 -c callable.zarr -r roh.bed.gz variants.vcf.gz\n</code></pre> <p>Non-ROH heterozygosity can serve as a proxy for the inbreeding load in a population (Kardos et al. 2025).</p> <p>The ROH file must be:</p> <ul> <li>BED format with sample name in the 4th column</li> <li>bgzipped and tabix indexed</li> </ul> <pre><code># Prepare ROH file\nsort -k1,1 -k2,2n roh.bed &gt; roh.sorted.bed\nbgzip roh.sorted.bed\ntabix -p bed roh.sorted.bed.gz\n</code></pre> <p>When ROH data is provided, the <code>heterozygosity.tsv</code> output includes additional columns for ROH-excluded statistics (<code>het_not_in_roh</code>, <code>callable_not_in_roh</code>, <code>heterozygosity_not_in_roh</code>).</p> <p>See Input Formats for file format details.</p>"},{"location":"how-to/calculate-statistics/#filtering-chromosomes","title":"Filtering Chromosomes","text":""},{"location":"how-to/calculate-statistics/#exclude-specific-chromosomes","title":"Exclude Specific Chromosomes","text":"<pre><code>clam stat -o results/ -w 10000 -c callable.zarr -x chrM,chrY variants.vcf.gz\n</code></pre>"},{"location":"how-to/calculate-statistics/#include-only-specific-chromosomes","title":"Include Only Specific Chromosomes","text":"<pre><code>clam stat -o results/ -w 10000 -c callable.zarr -i chr1,chr2,chr3 variants.vcf.gz\n</code></pre>"},{"location":"how-to/calculate-statistics/#output-files","title":"Output Files","text":"<p><code>clam stat</code> produces tab-separated files in the output directory:</p> File Description Generated <code>pi.tsv</code> Nucleotide diversity per population Always <code>dxy.tsv</code> Absolute divergence between populations When &gt;1 population <code>fst.tsv</code> Fixation index between populations When &gt;1 population <code>heterozygosity.tsv</code> Per-sample or per-population heterozygosity When callable sites provided <p>The <code>heterozygosity.tsv</code> file contains per-sample heterozygosity when using per-sample callable masks (<code>--per-sample</code> in <code>clam loci</code>), or per-population heterozygosity when using population counts. When ROH data is provided, additional columns report heterozygosity excluding samples in ROH regions.</p> <p>See Output Formats for column descriptions.</p>"},{"location":"how-to/calculate-statistics/#performance","title":"Performance","text":"<p>Use multiple threads for faster processing:</p> <pre><code>clam stat -o results/ -w 10000 -c callable.zarr -t 16 variants.vcf.gz\n</code></pre> <p>The chunk size affects parallelization and memory usage:</p> <pre><code>clam stat -o results/ -w 10000 -c callable.zarr --chunk-size 500000 variants.vcf.gz\n</code></pre> <p>Tip</p> <p>If you used <code>clam loci</code> with a specific chunk size, <code>clam stat</code> automatically uses the same chunk size when reading the callable Zarr.</p>"},{"location":"how-to/calculate-statistics/#complete-example","title":"Complete Example","text":"<pre><code># Calculate pi, dxy, and Fst in 50kb windows\n# - Use callable sites from loci\n# - Define two populations\n# - Calculate non-ROH heterozygosity\n# - Exclude mitochondria\n# - Use 16 threads\nclam stat \\\n  -o results/ \\\n  -w 50000 \\\n  -c callable.zarr \\\n  -p populations.tsv \\\n  -r roh.bed.gz \\\n  -x chrM \\\n  -t 16 \\\n  variants.vcf.gz\n</code></pre>"},{"location":"how-to/calculate-statistics/#working-with-results","title":"Working with Results","text":""},{"location":"how-to/calculate-statistics/#python","title":"Python","text":"<pre><code>import pandas as pd\n\npi = pd.read_csv(\"results/pi.tsv\", sep=\"\\t\")\ndxy = pd.read_csv(\"results/dxy.tsv\", sep=\"\\t\")\nfst = pd.read_csv(\"results/fst.tsv\", sep=\"\\t\")\n\n# Plot pi across chromosome 1\nchr1_pi = pi[pi[\"chrom\"] == \"chr1\"]\nchr1_pi.plot(x=\"start\", y=\"pi\", kind=\"line\")\n</code></pre>"},{"location":"how-to/calculate-statistics/#r","title":"R","text":"<pre><code>library(tidyverse)\n\npi &lt;- read_tsv(\"results/pi.tsv\")\ndxy &lt;- read_tsv(\"results/dxy.tsv\")\nfst &lt;- read_tsv(\"results/fst.tsv\")\n\n# Plot pi by population\nggplot(pi, aes(x=start, y=pi, color=population)) +\n  geom_line() +\n  facet_wrap(~chrom)\n</code></pre>"},{"location":"how-to/collect-depth-data/","title":"Collect Depth Data","text":"<p>This guide covers how to use <code>clam collect</code> to pre-process depth files into a Zarr store for efficient reuse.</p>"},{"location":"how-to/collect-depth-data/#when-to-use-collect","title":"When to Use collect","text":"<p>Use <code>clam collect</code> when you want to:</p> <ul> <li>Run <code>loci</code> multiple times with different threshold parameters</li> <li>Explore depth distributions across samples to decide on appropriate cutoffs</li> <li>Save storage space (Zarr is often smaller than merged D4 files)</li> <li>Improve performance for repeated analyses</li> </ul> <p>If you only need to run <code>loci</code> once with known thresholds, you can skip <code>collect</code> and pass depth files directly to <code>loci</code>.</p>"},{"location":"how-to/collect-depth-data/#prerequisites","title":"Prerequisites","text":"<ul> <li>Depth files in one of the supported formats:<ul> <li>Per-sample D4 files (uncompressed or bgzipped with index)</li> <li>Merged D4 files (uncompressed only)</li> <li>GVCF files (bgzipped and tabix indexed)</li> </ul> </li> </ul>"},{"location":"how-to/collect-depth-data/#basic-usage","title":"Basic Usage","text":"<pre><code>clam collect -o depths.zarr *.d4.gz\n</code></pre> <p>This reads all D4 files and stores the raw depth values in a Zarr store.</p>"},{"location":"how-to/collect-depth-data/#input-formats","title":"Input Formats","text":""},{"location":"how-to/collect-depth-data/#d4-files","title":"D4 Files","text":"<pre><code>clam collect -o depths.zarr sample1.d4.gz sample2.d4.gz sample3.d4.gz\n</code></pre> <p>See Input Formats for details on D4 file requirements.</p>"},{"location":"how-to/collect-depth-data/#merged-d4-files","title":"Merged D4 Files","text":"<pre><code>clam collect -o depths.zarr merged_samples.d4\n</code></pre> <p>clam automatically detects merged D4 files and extracts all sample names. Note that merged D4 files must be uncompressed.</p>"},{"location":"how-to/collect-depth-data/#gvcf-files","title":"GVCF Files","text":"<pre><code>clam collect -o depths.zarr --min-gq 20 *.g.vcf.gz\n</code></pre> <p>For GVCFs, you can filter by genotype quality (GQ) to exclude low-confidence depth values.</p>"},{"location":"how-to/collect-depth-data/#filtering-chromosomes","title":"Filtering Chromosomes","text":"<p>Exclude chromosomes you don't need to reduce storage:</p> <pre><code># Exclude mitochondria and unplaced contigs\nclam collect -o depths.zarr -x chrM,chrUn *.d4.gz\n\n# Only include autosomes\nclam collect -o depths.zarr -i chr1,chr2,chr3,chr4,chr5 *.d4.gz\n</code></pre>"},{"location":"how-to/collect-depth-data/#performance","title":"Performance","text":"<p>Use multiple threads for faster processing:</p> <pre><code>clam collect -o depths.zarr -t 16 *.d4.gz\n</code></pre> <p>Adjust chunk size if needed (default 1Mb):</p> <pre><code>clam collect -o depths.zarr --chunk-size 500000 *.d4.gz\n</code></pre>"},{"location":"how-to/collect-depth-data/#workflow-example","title":"Workflow Example","text":""},{"location":"how-to/collect-depth-data/#step-1-collect-depth-once","title":"Step 1: Collect Depth Once","text":"<pre><code>clam collect -o depths.zarr -t 16 *.d4.gz\n</code></pre>"},{"location":"how-to/collect-depth-data/#step-2-explore-depth-distributions","title":"Step 2: Explore Depth Distributions","text":"<p>Use Python to explore the depth distribution and decide on thresholds. See the example notebooks for detailed examples (coming soon).</p> <pre><code>import zarr\nimport numpy as np\n\nstore = zarr.open(\"depths.zarr\", mode=\"r\")\nchr1_depths = store[\"chr1\"][:]\n\n# Get per-sample mean depths\nmean_depths = np.mean(chr1_depths, axis=0)\nprint(f\"Mean depths per sample: {mean_depths}\")\n</code></pre>"},{"location":"how-to/collect-depth-data/#step-3-run-loci-with-different-thresholds","title":"Step 3: Run loci with Different Thresholds","text":"<pre><code># Conservative thresholds\nclam loci -o callable_strict.zarr -m 15 -M 80 depths.zarr\n\n# Relaxed thresholds\nclam loci -o callable_relaxed.zarr -m 5 -M 150 depths.zarr\n\n# Test different proportion requirements\nclam loci -o callable_d50.zarr -m 10 -d 0.5 depths.zarr\nclam loci -o callable_d80.zarr -m 10 -d 0.8 depths.zarr\n</code></pre> <p>Population Flow</p> <p>If you specified populations during <code>collect</code> (via <code>--samples</code>), they are stored in the Zarr metadata. <code>clam loci</code> reads them automatically, so you don't need to re-specify <code>-p</code> or <code>--samples</code>:</p> <pre><code># Populations were defined during collect\nclam collect -o depths.zarr --samples samples.tsv\n\n# loci reads populations from zarr metadata \u2014 no -p needed\nclam loci -o callable.zarr -m 10 depths.zarr\n\n# Override with different populations if needed\nclam loci -o callable.zarr -m 10 depths.zarr --samples different_pops.tsv\n</code></pre>"},{"location":"how-to/collect-depth-data/#step-4-compare-results","title":"Step 4: Compare Results","text":"<pre><code># Run stat with each callable set\nclam stat -o results_strict/ -w 10000 -c callable_strict.zarr variants.vcf.gz\nclam stat -o results_relaxed/ -w 10000 -c callable_relaxed.zarr variants.vcf.gz\n</code></pre>"},{"location":"how-to/collect-depth-data/#storage-efficiency","title":"Storage Efficiency","text":"<p>The Zarr format with Zstd compression typically achieves better compression than merged D4 files, especially for large sample counts. The exact savings depend on your data, but 20-50% reduction is common.</p>"},{"location":"how-to/collect-depth-data/#output-format","title":"Output Format","text":"<p>The output is a Zarr store containing:</p> <ul> <li>Raw depth values (uint32) for each sample at each position</li> <li>Metadata including sample names, chromosome lengths, chunk size, and population assignments (when specified)</li> </ul> <p>See Output Formats for details on the Zarr structure.</p>"},{"location":"how-to/collect-depth-data/#complete-example","title":"Complete Example","text":"<pre><code># Collect depth from 100 samples, excluding non-standard chromosomes\nclam collect \\\n  -o depths.zarr \\\n  --exclude-file exclude_chroms.txt \\\n  --chunk-size 1000000 \\\n  -t 16 \\\n  *.d4.gz\n\n# Now use the Zarr store for multiple loci runs\nclam loci -o callable_m10.zarr -m 10 -M 100 -p pops.tsv depths.zarr\nclam loci -o callable_m15.zarr -m 15 -M 100 -p pops.tsv depths.zarr\n</code></pre>"},{"location":"how-to/collect-depth-data/#next-steps","title":"Next Steps","text":"<p>After collecting depth data, use <code>clam loci</code> to generate callable sites:</p> <ul> <li>Generate Callable Loci</li> </ul> <p>Then calculate statistics with <code>clam stat</code>:</p> <ul> <li>Calculate Statistics</li> </ul>"},{"location":"how-to/generate-callable-loci/","title":"Generate Callable Loci","text":"<p>This guide covers how to use <code>clam loci</code> to identify genomic regions with sufficient sequencing depth to be considered callable.</p>"},{"location":"how-to/generate-callable-loci/#prerequisites","title":"Prerequisites","text":"<ul> <li>Depth files in one of the supported formats:<ul> <li>Per-sample D4 files (uncompressed or bgzipped with index)</li> <li>Merged D4 files (uncompressed only)</li> <li>GVCF files (bgzipped and tabix indexed)</li> <li>A Zarr store from <code>clam collect</code></li> </ul> </li> <li>Optional: population file or <code>--samples</code> TSV if analyzing multiple populations (not needed if the Zarr input already contains population metadata)</li> </ul>"},{"location":"how-to/generate-callable-loci/#input-formats","title":"Input Formats","text":""},{"location":"how-to/generate-callable-loci/#d4-files","title":"D4 Files","text":"<p>D4 files contain per-base depth estimates. You can generate them from BAM files using mosdepth:</p> <pre><code># Generate D4 from BAM\nmosdepth --d4 sample sample.bam\n\n# Compress and index (required by clam)\nbgzip sample.per-base.d4\nbgzip --index sample.per-base.d4.gz\n</code></pre>"},{"location":"how-to/generate-callable-loci/#gvcf-files","title":"GVCF Files","text":"<p>GVCF files must be bgzipped and tabix indexed:</p> <pre><code>bgzip sample.g.vcf\ntabix -p vcf sample.g.vcf.gz\n</code></pre>"},{"location":"how-to/generate-callable-loci/#basic-usage","title":"Basic Usage","text":"<pre><code>clam loci -o callable.zarr -m 10 sample1.d4.gz sample2.d4.gz sample3.d4.gz\n</code></pre> <p>This identifies sites where each sample has at least 10x depth.</p>"},{"location":"how-to/generate-callable-loci/#setting-depth-thresholds","title":"Setting Depth Thresholds","text":""},{"location":"how-to/generate-callable-loci/#per-sample-thresholds","title":"Per-Sample Thresholds","text":"<p>Control which sites are callable at the individual sample level:</p> <code>-m, --min-depth</code> Minimum depth required. Sites below this are not callable. <code>-M, --max-depth</code> Maximum depth allowed. Sites above this are not callable (often repetitive regions). <pre><code># Require 10-100x depth per sample\nclam loci -o callable.zarr -m 10 -M 100 *.d4.gz\n</code></pre>"},{"location":"how-to/generate-callable-loci/#site-level-thresholds","title":"Site-Level Thresholds","text":"<p>Apply filters across all samples at each site:</p> <code>-d, --min-proportion</code> Fraction of samples that must pass thresholds (0.0-1.0). <code>--min-mean-depth</code> Minimum mean depth across samples. <code>--max-mean-depth</code> Maximum mean depth across samples. <pre><code># Require 80% of samples to be callable at each site\nclam loci -o callable.zarr -m 10 -d 0.8 *.d4.gz\n</code></pre>"},{"location":"how-to/generate-callable-loci/#per-chromosome-thresholds","title":"Per-Chromosome Thresholds","text":"<p>For sex chromosomes or organellar genomes, use a thresholds file:</p> <pre><code># thresholds.tsv\nchr1    10  100\nchr2    10  100\nchrX    5   50\nchrY    5   50\nchrM    100 10000\n</code></pre> <pre><code>clam loci -o callable.zarr --thresholds-file thresholds.tsv *.d4.gz\n</code></pre> <p>See Input Formats for file format details.</p>"},{"location":"how-to/generate-callable-loci/#specifying-populations","title":"Specifying Populations","text":"<p>To calculate per-population callable counts (required for d<sub>xy</sub> and F<sub>ST</sub> downstream):</p> <pre><code>clam loci -o callable.zarr -m 10 -p populations.tsv *.d4.gz\n</code></pre> <p>The population file maps samples to populations:</p> <pre><code>sample1 PopA\nsample2 PopA\nsample3 PopB\nsample4 PopB\n</code></pre> <p>Sample Names</p> <p>Sample names must exactly match the identifiers in your input files. For D4 files, this is typically the filename prefix (e.g., <code>sample1</code> for <code>sample1.d4.gz</code>).</p> <p>See Input Formats for details.</p>"},{"location":"how-to/generate-callable-loci/#using-populations-from-a-zarr-store","title":"Using Populations from a Zarr Store","text":"<p>When your input is a Zarr store from <code>clam collect</code> (or a previous <code>clam loci</code> run) that already has population metadata, those populations are used automatically -- no <code>-p</code> or <code>--samples</code> flag needed:</p> <pre><code># Populations stored in depths.zarr are used automatically\nclam loci -o callable.zarr -m 10 depths.zarr\n</code></pre> <p>To override the stored populations with different assignments, use <code>--samples</code>:</p> <pre><code># Override populations from zarr with a new samples file\nclam loci -o callable.zarr -m 10 depths.zarr --samples samples.tsv\n</code></pre> <p>When using <code>--samples</code> with a Zarr input, the <code>file_path</code> column is not required -- only <code>sample_name</code> and <code>population</code> are needed:</p> <pre><code>sample_name population\nsample1 NewPopA\nsample2 NewPopA\nsample3 NewPopB\nsample4 NewPopB\n</code></pre> <p>Note</p> <p>If no populations are stored in the Zarr metadata and no <code>--samples</code> or <code>-p</code> flag is given, all samples are grouped into a single \"default\" population.</p>"},{"location":"how-to/generate-callable-loci/#filtering-chromosomes","title":"Filtering Chromosomes","text":""},{"location":"how-to/generate-callable-loci/#exclude-specific-chromosomes","title":"Exclude Specific Chromosomes","text":"<pre><code># Inline\nclam loci -o callable.zarr -m 10 -x chrM,chrY *.d4.gz\n\n# From file\nclam loci -o callable.zarr -m 10 --exclude-file exclude.txt *.d4.gz\n</code></pre>"},{"location":"how-to/generate-callable-loci/#include-only-specific-chromosomes","title":"Include Only Specific Chromosomes","text":"<pre><code># Inline\nclam loci -o callable.zarr -m 10 -i chr1,chr2,chr3 *.d4.gz\n\n# From file\nclam loci -o callable.zarr -m 10 --include-file autosomes.txt *.d4.gz\n</code></pre>"},{"location":"how-to/generate-callable-loci/#output-options","title":"Output Options","text":""},{"location":"how-to/generate-callable-loci/#per-sample-masks","title":"Per-Sample Masks","text":"<p>By default, <code>clam loci</code> outputs callable counts per population. To output per-sample boolean masks instead:</p> <pre><code>clam loci -o callable.zarr -m 10 --per-sample *.d4.gz\n</code></pre> <p>This is useful when you need sample-level callability information for other analyses.</p>"},{"location":"how-to/generate-callable-loci/#using-gvcf-input","title":"Using GVCF Input","text":"<p>For GVCF files, you can filter by genotype quality (GQ):</p> <pre><code>clam loci -o callable.zarr -m 10 --min-gq 20 *.g.vcf.gz\n</code></pre>"},{"location":"how-to/generate-callable-loci/#performance","title":"Performance","text":"<p>Use multiple threads for faster processing:</p> <pre><code>clam loci -o callable.zarr -m 10 -t 16 *.d4.gz\n</code></pre> <p>Adjust chunk size if needed (default 1Mb):</p> <pre><code>clam loci -o callable.zarr -m 10 --chunk-size 500000 *.d4.gz\n</code></pre>"},{"location":"how-to/generate-callable-loci/#complete-example","title":"Complete Example","text":"<pre><code># Process 50 samples with populations, excluding sex chromosomes\nclam loci \\\n  -o callable.zarr \\\n  -m 10 \\\n  -M 100 \\\n  -d 0.8 \\\n  -p populations.tsv \\\n  -x chrX,chrY,chrM \\\n  -t 16 \\\n  *.d4.gz\n</code></pre>"},{"location":"how-to/generate-callable-loci/#next-steps","title":"Next Steps","text":"<p>Use the output with <code>clam stat</code> to calculate population genetic statistics:</p> <pre><code>clam stat -o results/ -w 10000 -c callable.zarr variants.vcf.gz\n</code></pre> <p>See Calculate Statistics for details.</p>"},{"location":"reference/cli/","title":"CLI Reference","text":"<p>This page documents all clam commands and their options.</p>"},{"location":"reference/cli/#clam","title":"clam","text":"<pre><code>Population genetics analysis toolkit\n\nUsage: clam &lt;COMMAND&gt;\n\nCommands:\n  loci     Calculate callable sites from depth statistics\n  stat     Calculate population genetic statistics from VCF\n  collect  Collect depth from multiple files into a Zarr store\n  help     Print this message or the help of the given subcommand(s)\n\nOptions:\n  -h, --help     Print help\n  -V, --version  Print version\n</code></pre>"},{"location":"reference/cli/#clam-loci","title":"clam loci","text":"<p>Calculate callable sites from depth statistics.</p> <pre><code>Usage: clam loci [OPTIONS] --output &lt;OUTPUT&gt; [INPUT]...\n</code></pre>"},{"location":"reference/cli/#arguments","title":"Arguments","text":"<code>[INPUT]...</code> Input depth files. Accepts D4 files (bgzipped and indexed), GVCF files (bgzipped and tabix indexed), or a Zarr store from <code>clam collect</code>. Not required if using <code>--samples</code>. A single Zarr store can also be provided alongside <code>--samples</code> to use stored depth data with custom population assignments."},{"location":"reference/cli/#required-options","title":"Required Options","text":"<code>-o, --output &lt;OUTPUT&gt;</code> Output path for callable sites Zarr array."},{"location":"reference/cli/#depth-threshold-options","title":"Depth Threshold Options","text":"<code>-m, --min-depth &lt;MIN_DEPTH&gt;</code> Minimum depth to consider a site callable for each individual. [default: 0] <code>-M, --max-depth &lt;MAX_DEPTH&gt;</code> Maximum depth to consider a site callable for each individual. [default: inf] <code>-d, --min-proportion &lt;MIN_PROPORTION&gt;</code> Proportion of samples that must pass thresholds at a site to consider it callable. Value between 0.0 and 1.0. [default: 0] <code>--min-mean-depth &lt;MEAN_DEPTH_MIN&gt;</code> Minimum mean depth across all samples required at a site. [default: 0] <code>--max-mean-depth &lt;MEAN_DEPTH_MAX&gt;</code> Maximum mean depth across all samples allowed at a site. [default: inf] <code>--thresholds-file &lt;THRESHOLD_FILE&gt;</code> Custom thresholds per chromosome. Tab-separated file with columns: contig, min_depth, max_depth. See Input Formats."},{"location":"reference/cli/#output-options","title":"Output Options","text":"<code>--per-sample</code> Output per-sample boolean masks instead of per-population counts. Useful when you need sample-level callability information."},{"location":"reference/cli/#input-options","title":"Input Options","text":"<code>--min-gq &lt;MIN_GQ&gt;</code> Minimum genotype quality (GQ) to count depth. Only applies to GVCF input."},{"location":"reference/cli/#chromosome-filtering","title":"Chromosome Filtering","text":"<code>-x, --exclude &lt;EXCLUDE&gt;...</code> Comma-separated list of chromosomes to exclude. Example: <code>-x chrM,chrY</code> <code>--exclude-file &lt;EXCLUDE_FILE&gt;</code> Path to file with chromosomes to exclude, one per line. <code>-i, --include &lt;INCLUDE&gt;...</code> Comma-separated list of chromosomes to include (restrict analysis to). Example: <code>-i chr1,chr2,chr3</code> <code>--include-file &lt;INCLUDE_FILE&gt;</code> Path to file with chromosomes to include, one per line."},{"location":"reference/cli/#sample-input-options","title":"Sample Input Options","text":"<code>-s, --samples &lt;SAMPLES&gt;</code> Path to samples TSV file specifying sample names, file paths, and optionally populations. See Input Formats. When provided, positional input files are not allowed -- except when the sole positional argument is a Zarr store, in which case <code>--samples</code> provides population assignments only (the <code>file_path</code> column is not required). <code>-p, --population-file &lt;POPULATION_FILE&gt;</code> (Deprecated) Path to file that defines populations. Use <code>--samples</code> instead. See Input Formats."},{"location":"reference/cli/#performance-options","title":"Performance Options","text":"<code>-t, --threads &lt;THREADS&gt;</code> Number of threads to use for parallel processing. [default: 1] <code>--chunk-size &lt;CHUNK_SIZE&gt;</code> Chunk size for processing in base pairs. [default: 1000000]"},{"location":"reference/cli/#examples","title":"Examples","text":"<pre><code># Basic usage with D4 files\nclam loci -o callable.zarr -m 10 -M 100 sample1.d4.gz sample2.d4.gz\n\n# Using samples file (recommended for explicit sample naming)\nclam loci -o callable.zarr -m 10 --samples samples.tsv\n\n# With population file and 80% callability threshold (deprecated)\nclam loci -o callable.zarr -m 10 -d 0.8 -p populations.tsv *.d4.gz\n\n# Using GVCF input with GQ filter\nclam loci -o callable.zarr -m 10 --min-gq 20 sample1.g.vcf.gz sample2.g.vcf.gz\n\n# Exclude sex chromosomes\nclam loci -o callable.zarr -m 10 -x chrX,chrY *.d4.gz\n\n# Using Zarr input from clam collect\nclam loci -o callable.zarr -m 10 -M 100 depths.zarr\n\n# Using Zarr input \u2014 populations are auto-read from zarr metadata\nclam loci -o callable.zarr -m 10 depths.zarr\n\n# Using Zarr input with population override via --samples\nclam loci -o callable.zarr -m 10 depths.zarr --samples samples.tsv\n</code></pre>"},{"location":"reference/cli/#clam-stat","title":"clam stat","text":"<p>Calculate population genetic statistics from a VCF using callable site information.</p> <pre><code>Usage: clam stat [OPTIONS] --outdir &lt;OUTDIR&gt; &lt;VCF&gt;\n</code></pre>"},{"location":"reference/cli/#arguments_1","title":"Arguments","text":"<code>&lt;VCF&gt;</code> Path to input VCF file. Must be bgzipped and tabix indexed."},{"location":"reference/cli/#required-options_1","title":"Required Options","text":"<code>-o, --outdir &lt;OUTDIR&gt;</code> Output directory for statistics files. Will be created if it doesn't exist."},{"location":"reference/cli/#window-options","title":"Window Options","text":"<p>One of these options is required:</p> <code>-w, --window-size &lt;WINDOW_SIZE&gt;</code> Window size in base pairs for calculating statistics. <code>--regions-file &lt;REGIONS_FILE&gt;</code> BED file specifying regions to calculate statistics for. Use this for non-overlapping custom windows or specific genomic features."},{"location":"reference/cli/#callable-sites-options","title":"Callable Sites Options","text":"<code>-c, --callable &lt;CALLABLE&gt;</code> Path to callable sites Zarr array from <code>clam loci</code>. If not provided, all sites in the VCF are assumed callable."},{"location":"reference/cli/#roh-options","title":"ROH Options","text":"<code>-r, --roh &lt;ROH&gt;</code> Path to ROH (runs of homozygosity) regions BED file. Must be bgzipped and tabix indexed. Sample name should be in the 4th column. When provided, the <code>heterozygosity.tsv</code> output includes additional columns for heterozygosity calculated after excluding samples in ROH regions. See Input Formats."},{"location":"reference/cli/#chromosome-filtering_1","title":"Chromosome Filtering","text":"<code>-x, --exclude &lt;EXCLUDE&gt;...</code> Comma-separated list of chromosomes to exclude. <code>--exclude-file &lt;EXCLUDE_FILE&gt;</code> Path to file with chromosomes to exclude, one per line. <code>-i, --include &lt;INCLUDE&gt;...</code> Comma-separated list of chromosomes to include. <code>--include-file &lt;INCLUDE_FILE&gt;</code> Path to file with chromosomes to include, one per line."},{"location":"reference/cli/#population-options","title":"Population Options","text":"<code>-s, --samples &lt;SAMPLES&gt;</code> Path to samples TSV file specifying population assignments. Only <code>sample_name</code> and <code>population</code> columns are used; <code>file_path</code> is ignored. See Input Formats. <code>-p, --population-file &lt;POPULATION_FILE&gt;</code> (Deprecated) Path to file that defines populations. Use <code>--samples</code> instead. See Input Formats. <code>--force-samples</code> Only warn about samples in VCF that are not in population file, and exclude them from analysis. Without this flag, missing samples cause an error. <p>Automatic population detection</p> <p>When no <code>--samples</code> or <code>--population-file</code> is provided, <code>clam stat</code> automatically reads population definitions from the callable Zarr metadata (if populations were stored by <code>clam loci</code>). This means you don't need to re-specify populations if they were already defined during the <code>loci</code> step.</p>"},{"location":"reference/cli/#performance-options_1","title":"Performance Options","text":"<code>-t, --threads &lt;THREADS&gt;</code> Number of threads to use for parallel processing. [default: 1] <code>--chunk-size &lt;CHUNK_SIZE&gt;</code> Chunk size for parallel processing in base pairs. [default: 1000000]"},{"location":"reference/cli/#examples_1","title":"Examples","text":"<pre><code># Basic usage with 10kb windows\nclam stat -o results/ -w 10000 -c callable.zarr variants.vcf.gz\n\n# Populations auto-read from callable zarr (no -s or -p needed)\nclam stat -o results/ -w 10000 -c callable.zarr variants.vcf.gz\n\n# With population file for dxy and Fst\nclam stat -o results/ -w 10000 -c callable.zarr -p populations.tsv variants.vcf.gz\n\n# Override populations with --samples\nclam stat -o results/ -w 10000 -c callable.zarr -s samples.tsv variants.vcf.gz\n\n# Using custom regions from BED file\nclam stat -o results/ --regions-file genes.bed -c callable.zarr variants.vcf.gz\n\n# With ROH masking\nclam stat -o results/ -w 10000 -c callable.zarr -r roh.bed.gz variants.vcf.gz\n\n# Exclude mitochondria\nclam stat -o results/ -w 10000 -c callable.zarr -x chrM variants.vcf.gz\n</code></pre>"},{"location":"reference/cli/#clam-collect","title":"clam collect","text":"<p>Collect depth from multiple files into a Zarr store. Use this when you want to run <code>clam loci</code> multiple times with different threshold parameters.</p> <pre><code>Usage: clam collect [OPTIONS] --output &lt;OUTPUT&gt; [INPUT]...\n</code></pre>"},{"location":"reference/cli/#arguments_2","title":"Arguments","text":"<code>[INPUT]...</code> Input depth files. Accepts D4 files (bgzipped and indexed) or GVCF files (bgzipped and tabix indexed). Not required if using <code>--samples</code>."},{"location":"reference/cli/#required-options_2","title":"Required Options","text":"<code>-o, --output &lt;OUTPUT&gt;</code> Output path for depth Zarr array."},{"location":"reference/cli/#input-options_1","title":"Input Options","text":"<code>--min-gq &lt;MIN_GQ&gt;</code> Minimum genotype quality (GQ) to count depth. Only applies to GVCF input."},{"location":"reference/cli/#sample-input-options_1","title":"Sample Input Options","text":"<code>-s, --samples &lt;SAMPLES&gt;</code> Path to samples TSV file specifying sample names and file paths. See Input Formats. When provided, positional input files are not allowed."},{"location":"reference/cli/#chromosome-filtering_2","title":"Chromosome Filtering","text":"<code>-x, --exclude &lt;EXCLUDE&gt;...</code> Comma-separated list of chromosomes to exclude. <code>--exclude-file &lt;EXCLUDE_FILE&gt;</code> Path to file with chromosomes to exclude, one per line. <code>-i, --include &lt;INCLUDE&gt;...</code> Comma-separated list of chromosomes to include. <code>--include-file &lt;INCLUDE_FILE&gt;</code> Path to file with chromosomes to include, one per line."},{"location":"reference/cli/#performance-options_2","title":"Performance Options","text":"<code>-t, --threads &lt;THREADS&gt;</code> Number of threads to use for parallel processing. [default: 1] <code>--chunk-size &lt;CHUNK_SIZE&gt;</code> Chunk size for processing in base pairs. [default: 1000000]"},{"location":"reference/cli/#examples_2","title":"Examples","text":"<pre><code># Collect depth from D4 files\nclam collect -o depths.zarr -t 8 *.d4.gz\n\n# Using samples file (recommended for explicit sample naming)\nclam collect -o depths.zarr --samples samples.tsv\n\n# Collect from GVCFs with GQ filter\nclam collect -o depths.zarr --min-gq 20 *.g.vcf.gz\n\n# Then run loci multiple times with different thresholds\nclam loci -o callable_m5.zarr -m 5 depths.zarr\nclam loci -o callable_m10.zarr -m 10 depths.zarr\nclam loci -o callable_m15.zarr -m 15 depths.zarr\n</code></pre>"},{"location":"reference/cli/#shared-options","title":"Shared Options","text":"<p>These options are available across multiple commands:</p> Option Description Commands <code>-t, --threads</code> Number of threads for parallel processing all <code>-s, --samples</code> Samples TSV file with sample names, file paths, and populations <code>loci</code>, <code>collect</code>, <code>stat</code> <code>-p, --population-file</code> Population definitions file (deprecated, use <code>--samples</code>) <code>loci</code>, <code>stat</code> <code>-x, --exclude</code> Chromosomes to exclude (comma-separated) all <code>--exclude-file</code> File with chromosomes to exclude all <code>-i, --include</code> Chromosomes to include (comma-separated) all <code>--include-file</code> File with chromosomes to include all <code>--chunk-size</code> Processing chunk size in bp all"},{"location":"reference/input-formats/","title":"Input File Formats","text":"<p>This page documents the file formats accepted by clam.</p>"},{"location":"reference/input-formats/#depth-files","title":"Depth Files","text":""},{"location":"reference/input-formats/#d4-files","title":"D4 Files","text":"<p>D4 is a compact format for storing per-base depth information.</p> <p>Formats accepted:</p> <ul> <li>Uncompressed D4 (<code>.d4</code>)</li> <li>Bgzipped D4 with index (<code>.d4.gz</code> + <code>.d4.gz.gzi</code>)</li> </ul> <p>Generating D4 files:</p> <pre><code># Generate D4 from BAM using mosdepth\nmosdepth --d4 sample sample.bam\n\n# Optionally bgzip and index to save disk space\nbgzip --index sample.per-base.d4\n</code></pre> <p>Sample name extraction:</p> <p>When using positional arguments, clam extracts sample names from D4 filenames. For a file named <code>sample1.per-base.d4.gz</code>, the sample name is <code>sample1</code> (the part before the first <code>.</code>).</p> <p>To use explicit sample names instead, use the <code>--samples</code> option with a samples file.</p>"},{"location":"reference/input-formats/#gvcf-files","title":"GVCF Files","text":"<p>GVCF (Genomic VCF) files contain per-sample depth and genotype quality information at every position.</p> <p>Requirements:</p> <ul> <li>Must be bgzipped (<code>.g.vcf.gz</code>)</li> <li>Must be tabix indexed (<code>.g.vcf.gz.tbi</code>)</li> </ul> <p>Generating indexed GVCFs:</p> <pre><code>bgzip sample.g.vcf\ntabix -p vcf sample.g.vcf.gz\n</code></pre> <p>Sample name extraction:</p> <p>When using positional arguments, sample names are extracted from the filename. For a file named <code>sample1.g.vcf.gz</code>, the sample name is <code>sample1</code> (the part before the first <code>.</code>).</p> <p>To use explicit sample names instead, use the <code>--samples</code> option with a samples file.</p>"},{"location":"reference/input-formats/#vcf-files","title":"VCF Files","text":"<p>For <code>clam stat</code>, input VCF files must be bgzipped and tabix indexed.</p> <p>Requirements:</p> <ul> <li>Must be bgzipped (<code>.vcf.gz</code>)</li> <li>Must be tabix indexed (<code>.vcf.gz.tbi</code>)</li> </ul>"},{"location":"reference/input-formats/#samples-file","title":"Samples File","text":"<p>Specifies sample names, input file paths, and optionally population assignments. This is the recommended way to provide input to <code>clam loci</code> and <code>clam collect</code> as it allows explicit control over sample naming.</p> <p>Format: Tab-separated with header. The <code>sample_name</code> and <code>file_path</code> columns are required; <code>population</code> is optional.</p> Column Required Description <code>sample_name</code> Yes Unique sample identifier <code>file_path</code> Conditional Path to depth file (D4 or GVCF). Required for <code>collect</code> and <code>loci</code> with raw depth input. Not required when used with <code>loci</code> + zarr input (population override) or with <code>stat</code>. <code>population</code> No Population assignment <p>Example with populations:</p> <pre><code>sample_name file_path   population\nsample1 /path/to/sample1.d4.gz  PopA\nsample2 /path/to/sample2.d4.gz  PopA\nsample3 /path/to/sample3.d4.gz  PopB\nsample4 /path/to/sample4.d4.gz  PopB\n</code></pre> <p>Example without populations:</p> <pre><code>sample_name file_path\nsample1 /path/to/abc.sample1.d4.gz\nsample2 /path/to/abc.sample2.d4.gz\nsample3 /path/to/abc.sample3.d4.gz\n</code></pre> <p>Example for population override (no file_path):</p> <pre><code>sample_name population\nsample1 PopA\nsample2 PopA\nsample3 PopB\nsample4 PopB\n</code></pre> <p>This format is used when providing <code>--samples</code> to:</p> <ul> <li><code>clam loci</code> with a Zarr positional argument (population override only)</li> <li><code>clam stat</code> (population assignment only)</li> </ul> <p>Notes:</p> <ul> <li>Column order doesn't matter (detected from header)</li> <li>Sample names must be unique</li> <li>If the <code>population</code> column is present, all rows must have values</li> <li>If the <code>population</code> column is absent, all samples are assigned to a \"default\" population</li> <li>File paths can be absolute or relative to the current working directory</li> <li>When <code>file_path</code> is not required (e.g., <code>stat</code> or <code>loci</code> with zarr input), the column can be omitted entirely</li> <li>Use this format when filenames don't match desired sample names (e.g., files named <code>abc.sample1.d4.gz</code> but you want sample name <code>sample1</code>)</li> </ul> <p>Usage:</p> <pre><code>clam loci -o callable.zarr -m 10 --samples samples.tsv\nclam loci -o callable.zarr -m 10 depths.zarr --samples samples.tsv  # population override\nclam collect -o depths.zarr --samples samples.tsv\nclam stat -o results/ -w 10000 -c callable.zarr --samples samples.tsv\n</code></pre>"},{"location":"reference/input-formats/#population-file","title":"Population File","text":"<p>Deprecated</p> <p>The <code>--population-file</code> option is deprecated. Use <code>--samples</code> with a <code>population</code> column instead.</p> <p>Defines which samples belong to which population. Used by both <code>clam loci</code> and <code>clam stat</code>.</p> <p>Format: Tab-separated, two columns, no header.</p> Column Description 1 Sample name 2 Population name <p>Example:</p> <pre><code>sample1 PopA\nsample2 PopA\nsample3 PopA\nsample4 PopB\nsample5 PopB\nsample6 PopC\n</code></pre> <p>Notes:</p> <ul> <li>Sample names must exactly match those in your input files</li> <li>For D4 files, sample names are derived from filenames (the part before the first <code>.</code>)</li> <li>For VCF/GVCF files, sample names come from the file header</li> <li>Each sample should appear exactly once</li> <li>Population names can be any string (no spaces)</li> </ul>"},{"location":"reference/input-formats/#chromosome-includeexclude-files","title":"Chromosome Include/Exclude Files","text":"<p>Specify chromosomes to include or exclude from analysis.</p> <p>Format: One chromosome name per line, no header.</p> <p>Example (<code>exclude_chroms.txt</code>):</p> <pre><code>chrM\nchrY\nchrUn_gl000220\n</code></pre> <p>Example (<code>include_chroms.txt</code>):</p> <pre><code>chr1\nchr2\nchr3\nchr4\nchr5\n</code></pre> <p>Usage:</p> <pre><code># Exclude specific chromosomes\nclam loci --exclude-file exclude_chroms.txt ...\n\n# Only analyze specific chromosomes\nclam loci --include-file include_chroms.txt ...\n</code></pre>"},{"location":"reference/input-formats/#per-chromosome-thresholds-file","title":"Per-Chromosome Thresholds File","text":"<p>Specify different depth thresholds for different chromosomes. Useful for sex chromosomes or organellar genomes.</p> <p>Format: Tab-separated, three columns, no header.</p> Column Description 1 Chromosome name 2 Minimum depth 3 Maximum depth <p>Example:</p> <pre><code>chr1    10  100\nchr2    10  100\nchrX    5   50\nchrY    5   50\nchrM    100 10000\n</code></pre> <p>Notes:</p> <ul> <li>Chromosomes not listed in the file will use the default thresholds from <code>-m</code> and <code>-M</code> options</li> <li>This allows setting lower thresholds for hemizygous chromosomes (X, Y in XY individuals)</li> <li>Mitochondrial/chloroplast genomes often need much higher thresholds</li> </ul>"},{"location":"reference/input-formats/#roh-file","title":"ROH File","text":"<p>Specifies runs of homozygosity (ROH) regions per sample. Used by <code>clam stat</code> to exclude samples within ROH regions when calculating diversity, enabling estimation of non-ROH heterozygosity (\u03c0<sub>non-ROH</sub>).</p> <p>Format: BED format (tab-separated) with sample name in the 4th column.</p> Column Description 1 Chromosome 2 Start position (0-based) 3 End position 4 Sample name <p>Requirements:</p> <ul> <li>Must be bgzipped (<code>.bed.gz</code>)</li> <li>Must be tabix indexed (<code>.bed.gz.tbi</code>)</li> </ul> <p>Example (<code>roh.bed</code>):</p> <pre><code>chr1    1000000 2000000 sample1\nchr1    5000000 5500000 sample1\nchr1    1500000 2500000 sample2\nchr2    3000000 4000000 sample1\n</code></pre> <p>Preparing the file:</p> <pre><code># Sort by chromosome and position\nsort -k1,1 -k2,2n roh.bed &gt; roh.sorted.bed\n\n# Compress and index\nbgzip roh.sorted.bed\ntabix -p bed roh.sorted.bed.gz\n</code></pre> <p>Notes:</p> <ul> <li>Sample names must match those in your VCF</li> <li>ROH regions can overlap between samples</li> <li>Coordinates are 0-based, half-open (standard BED format)</li> </ul>"},{"location":"reference/input-formats/#regions-file","title":"Regions File","text":"<p>Specifies custom regions for calculating statistics in <code>clam stat</code>. Use this instead of <code>--window-size</code> for non-uniform windows or specific genomic features.</p> <p>Format: Standard BED format (tab-separated).</p> Column Description 1 Chromosome 2 Start position (0-based) 3 End position <p>Example (<code>genes.bed</code>):</p> <pre><code>chr1    11869   14409\nchr1    14404   29570\nchr1    17369   17436\nchr2    38814   46588\n</code></pre> <p>Notes:</p> <ul> <li>Coordinates are 0-based, half-open (standard BED format)</li> <li>Regions can be of variable size</li> <li>Regions should not overlap (statistics are calculated independently per region)</li> <li>Additional columns (name, score, etc.) are ignored</li> </ul>"},{"location":"reference/input-formats/#summary-table","title":"Summary Table","text":"File Type Extension Index Required Used By D4 depth <code>.d4</code> or <code>.d4.gz</code> <code>.d4.gz.gzi</code> (if compressed) <code>loci</code>, <code>collect</code> GVCF <code>.g.vcf.gz</code> <code>.g.vcf.gz.tbi</code> <code>loci</code>, <code>collect</code> VCF <code>.vcf.gz</code> <code>.vcf.gz.tbi</code> <code>stat</code> Samples <code>.tsv</code> No <code>loci</code>, <code>collect</code>, <code>stat</code> Population <code>.tsv</code> No <code>loci</code>, <code>stat</code> (deprecated for <code>loci</code>) Chromosome list <code>.txt</code> No <code>loci</code>, <code>stat</code>, <code>collect</code> Thresholds <code>.tsv</code> No <code>loci</code> ROH <code>.bed.gz</code> <code>.bed.gz.tbi</code> <code>stat</code> Regions <code>.bed</code> No <code>stat</code>"},{"location":"reference/output-formats/","title":"Output File Formats","text":"<p>This page documents the output files produced by clam commands.</p>"},{"location":"reference/output-formats/#zarr-format-overview","title":"Zarr Format Overview","text":"<p>clam uses Zarr for its intermediate and output files. Zarr is a format for storing chunked, compressed N-dimensional arrays. Zarr enables better compression for storing multisample per-base values (depth in this case) than. Please see this small benchmark for a comparison. </p> <p>Schema Stability</p> <p>The Zarr schema (metadata structure, array layout) is not yet stable and may change in future versions of clam. If you are building tools that read clam's Zarr outputs, please reach out via Github issue with any feedback and/or your use case(s).  </p>"},{"location":"reference/output-formats/#depth-zarr-store","title":"Depth Zarr Store","text":"<p><code>clam collect</code> produces a Zarr store containing raw depth values for all samples.</p> <p>Structure:</p> <pre><code>depths.zarr/\n\u251c\u2500\u2500 zarr.json           # Zarr v3 metadata\n\u251c\u2500\u2500 chr1/               # Per-chromosome arrays\n\u2502   \u2514\u2500\u2500 ...\n\u251c\u2500\u2500 chr2/\n\u2502   \u2514\u2500\u2500 ...\n\u2514\u2500\u2500 ...\n</code></pre> <p>Root Metadata (<code>clam_metadata</code>):</p> <pre><code>{\n  \"contigs\": [\n    {\"name\": \"chr1\", \"length\": 248956422},\n    {\"name\": \"chr2\", \"length\": 242193529}\n  ],\n  \"column_names\": [\"sample1\", \"sample2\", \"sample3\"],\n  \"chunk_size\": 1000000,\n  \"populations\": [\n    {\"name\": \"PopA\", \"samples\": [\"sample1\", \"sample2\"]},\n    {\"name\": \"PopB\", \"samples\": [\"sample3\"]}\n  ]\n}\n</code></pre> Field Type Description <code>contigs</code> array List of chromosomes with names and lengths <code>column_names</code> array Sample names in column order <code>chunk_size</code> integer Chunk size in base pairs <code>populations</code> array Population definitions with sample membership (present when populations were specified during <code>collect</code>) <p>Note</p> <p>The <code>populations</code> field is present when populations were defined via <code>--samples</code> or <code>--population-file</code> during the <code>collect</code> step. This metadata is automatically read by <code>clam loci</code> when the zarr store is used as input.</p> <p>Array Properties:</p> Property Value Data type <code>uint32</code> Shape <code>(chromosome_length, num_samples)</code> Chunk shape <code>(chunk_size, num_samples)</code> Compression Blosc (Zstd, level 5, byte shuffle) <p>Per-Chromosome Metadata (<code>contig_info</code>):</p> <pre><code>{\n  \"contig\": \"chr1\",\n  \"length\": 248956422\n}\n</code></pre>"},{"location":"reference/output-formats/#clam-loci-output","title":"clam loci Output","text":""},{"location":"reference/output-formats/#callable-sites-zarr-store-default","title":"Callable Sites Zarr Store (default)","text":"<p>By default, <code>clam loci</code> produces a Zarr store containing callable sample counts per population.</p> <p>Structure: Same as depth Zarr (see above).</p> <p>Root Metadata (<code>clam_metadata</code>):</p> <pre><code>{\n  \"contigs\": [\n    {\"name\": \"chr1\", \"length\": 248956422},\n    {\"name\": \"chr2\", \"length\": 242193529}\n  ],\n  \"column_names\": [\"PopA\", \"PopB\", \"PopC\"],\n  \"chunk_size\": 1000000,\n  \"callable_loci_type\": \"population_counts\",\n  \"populations\": [\n    {\"name\": \"PopA\", \"samples\": [\"sample1\", \"sample2\", \"sample3\"]},\n    {\"name\": \"PopB\", \"samples\": [\"sample4\", \"sample5\"]},\n    {\"name\": \"PopC\", \"samples\": [\"sample6\", \"sample7\", \"sample8\"]}\n  ]\n}\n</code></pre> Field Type Description <code>contigs</code> array List of chromosomes with names and lengths <code>column_names</code> array Population names in column order <code>chunk_size</code> integer Chunk size in base pairs <code>callable_loci_type</code> string Type of callable loci data (<code>population_counts</code>) <code>populations</code> array Population definitions with sample membership (see below) <p>Population metadata:</p> Field Type Description <code>name</code> string Population name <code>samples</code> array List of sample names in this population <p>Array Properties:</p> Property Value Data type <code>uint16</code> Shape <code>(chromosome_length, num_populations)</code> Chunk shape <code>(chunk_size, num_populations)</code> Compression Blosc (Zstd, level 5, byte shuffle) <p>Data interpretation:</p> <p>Each value represents the number of samples in that population that are callable at that position. For example, if <code>PopA</code> has 10 samples and the value at position 1000 is 8, then 8 of the 10 samples in <code>PopA</code> are callable at position 1000.</p>"},{"location":"reference/output-formats/#per-sample-mask-zarr-store-per-sample","title":"Per-Sample Mask Zarr Store (<code>--per-sample</code>)","text":"<p>When using <code>--per-sample</code>, <code>clam loci</code> outputs a boolean mask indicating callability for each sample.</p> <p>Root Metadata (<code>clam_metadata</code>):</p> <pre><code>{\n  \"contigs\": [\n    {\"name\": \"chr1\", \"length\": 248956422}\n  ],\n  \"column_names\": [\"sample1\", \"sample2\", \"sample3\"],\n  \"chunk_size\": 1000000,\n  \"callable_loci_type\": \"sample_masks\",\n  \"populations\": [\n    {\"name\": \"PopA\", \"samples\": [\"sample1\", \"sample2\"]},\n    {\"name\": \"PopB\", \"samples\": [\"sample3\"]}\n  ]\n}\n</code></pre> Field Type Description <code>contigs</code> array List of chromosomes with names and lengths <code>column_names</code> array Sample names in column order <code>chunk_size</code> integer Chunk size in base pairs <code>callable_loci_type</code> string Type of callable loci data (<code>sample_masks</code>) <code>populations</code> array Population definitions with sample membership <p>Array Properties:</p> Property Value Data type <code>bool</code> Shape <code>(chromosome_length, num_samples)</code> Chunk shape <code>(chunk_size, num_samples)</code> Compression PackBits <p>Data interpretation:</p> <ul> <li><code>true</code>: Site is callable for this sample</li> <li><code>false</code>: Site is not callable for this sample</li> </ul>"},{"location":"reference/output-formats/#clam-stat-output","title":"clam stat Output","text":"<p><code>clam stat</code> produces tab-separated (TSV) files in the specified output directory.</p>"},{"location":"reference/output-formats/#pitsv","title":"pi.tsv","text":"<p>Nucleotide diversity (\u03c0) per population per window.</p> <p>Always generated.</p> Column Type Description <code>chrom</code> string Chromosome name <code>start</code> integer Window start position (1-based) <code>end</code> integer Window end position (1-based, inclusive) <code>population</code> string Population name <code>pi</code> float Nucleotide diversity estimate <code>comparisons</code> integer Total pairwise comparisons (denominator) <code>differences</code> integer Pairwise differences observed (numerator) <p>Example:</p> <pre><code>chrom   start   end population  pi  comparisons differences\nchr1    1   10000   PopA    0.00234 4500000 10530\nchr1    1   10000   PopB    0.00198 3800000 7524\nchr1    10001   20000   PopA    0.00241 4600000 11086\n</code></pre> <p>Notes:</p> <ul> <li><code>pi = differences / comparisons</code></li> <li><code>comparisons</code> includes both variant and invariant callable sites</li> <li><code>NaN</code> indicates no valid comparisons in the window</li> </ul>"},{"location":"reference/output-formats/#dxytsv","title":"dxy.tsv","text":"<p>Absolute divergence (d<sub>xy</sub>) between population pairs.</p> <p>Generated only when &gt;1 population is defined.</p> Column Type Description <code>chrom</code> string Chromosome name <code>start</code> integer Window start position (1-based) <code>end</code> integer Window end position (1-based, inclusive) <code>population1</code> string First population name <code>population2</code> string Second population name <code>dxy</code> float Absolute divergence estimate <code>comparisons</code> integer Total between-population comparisons <code>differences</code> integer Between-population differences <p>Example:</p> <pre><code>chrom   start   end population1 population2 dxy comparisons differences\nchr1    1   10000   PopA    PopB    0.00312 8500000 26520\nchr1    1   10000   PopA    PopC    0.00287 7200000 20664\nchr1    1   10000   PopB    PopC    0.00301 6800000 20468\n</code></pre> <p>Notes:</p> <ul> <li>One row per population pair per window</li> <li>Population pairs are unordered (<code>PopA-PopB</code> is the same as <code>PopB-PopA</code>)</li> <li><code>dxy = differences / comparisons</code></li> </ul>"},{"location":"reference/output-formats/#fsttsv","title":"fst.tsv","text":"<p>Fixation index (F<sub>ST</sub>) between population pairs.</p> <p>Generated only when &gt;1 population is defined.</p> Column Type Description <code>chrom</code> string Chromosome name <code>start</code> integer Window start position (1-based) <code>end</code> integer Window end position (1-based, inclusive) <code>population1</code> string First population name <code>population2</code> string Second population name <code>fst</code> float F<sub>ST</sub> estimate (Hudson estimator) <p>Example:</p> <pre><code>chrom   start   end population1 population2 fst\nchr1    1   10000   PopA    PopB    0.156\nchr1    1   10000   PopA    PopC    0.089\nchr1    1   10000   PopB    PopC    0.201\n</code></pre> <p>Notes:</p> <ul> <li>F<sub>ST</sub> is calculated using the Hudson estimator: F<sub>ST</sub> = (d<sub>xy</sub> - \u03c0<sub>avg</sub>) / d<sub>xy</sub></li> <li>Values range from 0 (no differentiation) to 1 (complete differentiation)</li> <li>Negative values can occur when within-population diversity exceeds between-population divergence</li> <li><code>NaN</code> indicates undefined F<sub>ST</sub> (e.g., no polymorphic sites)</li> </ul>"},{"location":"reference/output-formats/#heterozygositytsv","title":"heterozygosity.tsv","text":"<p>Per-sample or per-population heterozygosity.</p> <p>Generated only when callable sites are provided.</p> Column Type Description <code>chrom</code> string Chromosome name <code>start</code> integer Window start position (1-based) <code>end</code> integer Window end position (1-based, inclusive) <code>sample</code> string Sample name (only in per-sample mode) <code>population</code> string Population name <code>het_total</code> integer Number of heterozygous sites <code>callable_total</code> integer Number of callable sites <code>heterozygosity</code> float Heterozygosity rate (het_total / callable_total) <code>het_not_in_roh</code> integer Het sites excluding ROH (if <code>--roh</code> provided) <code>callable_not_in_roh</code> integer Callable sites excluding ROH (if <code>--roh</code> provided) <code>heterozygosity_not_in_roh</code> float Heterozygosity excluding ROH (if <code>--roh</code> provided) <p>Example (per-sample mode):</p> <pre><code>chrom   start   end sample  population  het_total   callable_total  heterozygosity  het_not_in_roh  callable_not_in_roh heterozygosity_not_in_roh\nchr1    1   10000   sample1 PopA    234 9500    0.0246  220 9000    0.0244\nchr1    1   10000   sample2 PopA    198 9200    0.0215  198 9200    0.0215\n</code></pre> <p>Example (per-population mode):</p> <pre><code>chrom   start   end population  het_total   callable_total  heterozygosity  het_not_in_roh  callable_not_in_roh heterozygosity_not_in_roh\nchr1    1   10000   PopA    1856    94500   0.0196  1750    89000   0.0197\nchr1    1   10000   PopB    2134    96000   0.0222  2134    96000   0.0222\n</code></pre> <p>Notes:</p> <ul> <li>Per-sample mode is used when callable sites were generated with <code>--per-sample</code> in <code>clam loci</code></li> <li>Per-population mode is used when callable sites contain population counts (default <code>clam loci</code> output)</li> </ul>"},{"location":"reference/output-formats/#output-summary","title":"Output Summary","text":"Command Output Format Description <code>collect</code> <code>*.zarr/</code> Zarr Raw depth values (uint32) <code>loci</code> <code>*.zarr/</code> Zarr Callable counts (uint16) or masks (bool) <code>stat</code> <code>pi.tsv</code> TSV Nucleotide diversity <code>stat</code> <code>dxy.tsv</code> TSV Absolute divergence (if &gt;1 pop) <code>stat</code> <code>fst.tsv</code> TSV Fixation index (if &gt;1 pop) <code>stat</code> <code>heterozygosity.tsv</code> TSV Heterozygosity (if callable sites provided)"},{"location":"reference/output-formats/#working-with-outputs","title":"Working with Outputs","text":""},{"location":"reference/output-formats/#reading-zarr-in-python","title":"Reading Zarr in Python","text":"<pre><code>import zarr\n\n# Open store\nstore = zarr.open(\"callable.zarr\", mode=\"r\")\n\n# Get metadata\nmeta = store.attrs[\"clam_metadata\"]\npopulations = meta[\"column_names\"]\nchunk_size = meta[\"chunk_size\"]\n\n# Read chromosome data\nchr1 = store[\"chr1\"][:]  # Shape: (chrom_length, num_populations)\n\n# Read specific region (efficient)\nregion = store[\"chr1\"][1000000:2000000, :]\n</code></pre> <p>For more detailed examples of working with Zarr outputs, including exploring depth distributions, see the example notebooks (coming soon).</p>"},{"location":"tutorial/01_overview/","title":"Getting Started","text":"<p>Work in Progress</p> <p>This tutorial is under development. Check back soon for a complete walkthrough using example data.</p> <p>This tutorial will guide you through a complete clam workflow using example data, from raw depth files to population genetic statistics.</p>"},{"location":"tutorial/01_overview/#what-youll-learn","title":"What You'll Learn","text":"<ul> <li>How to prepare input files for clam</li> <li>Generate callable loci with <code>clam loci</code></li> <li>Calculate \u03c0, d<sub>xy</sub>, and F<sub>ST</sub> with <code>clam stat</code></li> <li>Interpret and visualize the results</li> </ul>"},{"location":"tutorial/01_overview/#prerequisites","title":"Prerequisites","text":"<ul> <li>clam installed (see Installation)</li> <li>Basic familiarity with command-line tools</li> <li>Python or R for visualization (optional)</li> </ul>"},{"location":"tutorial/01_overview/#example-dataset","title":"Example Dataset","text":"<p>This tutorial uses simulated data from the clam test suite, representing:</p> <ul> <li>20 samples across 2 populations (Pop1, Pop2)</li> <li>10 samples per population</li> <li>D4 depth files and a variants-only VCF</li> </ul>"},{"location":"tutorial/01_overview/#tutorial-outline","title":"Tutorial Outline","text":""},{"location":"tutorial/01_overview/#part-1-prepare-your-data","title":"Part 1: Prepare Your Data","text":"<ul> <li>Organize depth files (D4 or GVCF)</li> <li>Create a population file</li> <li>Inspect chromosome names and lengths</li> </ul>"},{"location":"tutorial/01_overview/#part-2-generate-callable-loci","title":"Part 2: Generate Callable Loci","text":"<ul> <li>Choose appropriate depth thresholds</li> <li>Run <code>clam loci</code> with population definitions</li> <li>Examine the output Zarr store</li> </ul>"},{"location":"tutorial/01_overview/#part-3-calculate-statistics","title":"Part 3: Calculate Statistics","text":"<ul> <li>Run <code>clam stat</code> with the callable loci</li> <li>Understand window-based calculations</li> <li>Explore the output TSV files</li> </ul>"},{"location":"tutorial/01_overview/#part-4-analyze-results","title":"Part 4: Analyze Results","text":"<ul> <li>Load results in Python/R</li> <li>Plot diversity across the genome</li> <li>Compare populations</li> </ul>"},{"location":"tutorial/01_overview/#coming-soon","title":"Coming Soon","text":"<p>Full tutorial content with step-by-step instructions and example code.</p> <p>In the meantime, see:</p> <ul> <li>How-to: Generate Callable Loci</li> <li>How-to: Calculate Statistics</li> <li>Core Concepts</li> </ul>"}]}