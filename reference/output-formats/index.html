
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../input-formats/">
      
      
      
        
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.2">
    
    
      
        <title>Output File Formats - clam</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#output-file-formats" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="clam" class="md-header__button md-logo" aria-label="clam" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            clam
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Output File Formats
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/cademirch/clam" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="clam" class="md-nav__button md-logo" aria-label="clam" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    clam
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/cademirch/clam" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    clam
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    clam
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../explanation/why-clam/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Why clam?
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../explanation/concepts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Core Concepts
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Tutorial
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Tutorial
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/01_overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Getting Started
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    How-to Guides
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    How-to Guides
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../how-to/generate-callable-loci/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Generate Callable Loci
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../how-to/calculate-statistics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Calculate Statistics
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../how-to/collect-depth-data/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Collect Depth Data
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Reference
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cli/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    CLI Reference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../input-formats/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Input Formats
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Output Formats
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Output Formats
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#zarr-format-overview" class="md-nav__link">
    <span class="md-ellipsis">
      
        Zarr Format Overview
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Zarr Format Overview">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#depth-zarr-store" class="md-nav__link">
    <span class="md-ellipsis">
      
        Depth Zarr Store
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#clam-loci-output" class="md-nav__link">
    <span class="md-ellipsis">
      
        clam loci Output
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="clam loci Output">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#callable-sites-zarr-store-default" class="md-nav__link">
    <span class="md-ellipsis">
      
        Callable Sites Zarr Store (default)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#per-sample-mask-zarr-store-per-sample" class="md-nav__link">
    <span class="md-ellipsis">
      
        Per-Sample Mask Zarr Store (--per-sample)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#clam-stat-output" class="md-nav__link">
    <span class="md-ellipsis">
      
        clam stat Output
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="clam stat Output">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pitsv" class="md-nav__link">
    <span class="md-ellipsis">
      
        pi.tsv
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dxytsv" class="md-nav__link">
    <span class="md-ellipsis">
      
        dxy.tsv
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fsttsv" class="md-nav__link">
    <span class="md-ellipsis">
      
        fst.tsv
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#heterozygositytsv" class="md-nav__link">
    <span class="md-ellipsis">
      
        heterozygosity.tsv
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#output-summary" class="md-nav__link">
    <span class="md-ellipsis">
      
        Output Summary
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#working-with-outputs" class="md-nav__link">
    <span class="md-ellipsis">
      
        Working with Outputs
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Working with Outputs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#reading-zarr-in-python" class="md-nav__link">
    <span class="md-ellipsis">
      
        Reading Zarr in Python
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#zarr-format-overview" class="md-nav__link">
    <span class="md-ellipsis">
      
        Zarr Format Overview
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Zarr Format Overview">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#depth-zarr-store" class="md-nav__link">
    <span class="md-ellipsis">
      
        Depth Zarr Store
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#clam-loci-output" class="md-nav__link">
    <span class="md-ellipsis">
      
        clam loci Output
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="clam loci Output">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#callable-sites-zarr-store-default" class="md-nav__link">
    <span class="md-ellipsis">
      
        Callable Sites Zarr Store (default)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#per-sample-mask-zarr-store-per-sample" class="md-nav__link">
    <span class="md-ellipsis">
      
        Per-Sample Mask Zarr Store (--per-sample)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#clam-stat-output" class="md-nav__link">
    <span class="md-ellipsis">
      
        clam stat Output
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="clam stat Output">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pitsv" class="md-nav__link">
    <span class="md-ellipsis">
      
        pi.tsv
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dxytsv" class="md-nav__link">
    <span class="md-ellipsis">
      
        dxy.tsv
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fsttsv" class="md-nav__link">
    <span class="md-ellipsis">
      
        fst.tsv
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#heterozygositytsv" class="md-nav__link">
    <span class="md-ellipsis">
      
        heterozygosity.tsv
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#output-summary" class="md-nav__link">
    <span class="md-ellipsis">
      
        Output Summary
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#working-with-outputs" class="md-nav__link">
    <span class="md-ellipsis">
      
        Working with Outputs
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Working with Outputs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#reading-zarr-in-python" class="md-nav__link">
    <span class="md-ellipsis">
      
        Reading Zarr in Python
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
    <a href="https://github.com/cademirch/clam/edit/master/docs/reference/output-formats.md" title="Edit this page" class="md-content__button md-icon" rel="edit">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  


<h1 id="output-file-formats">Output File Formats</h1>
<p>This page documents the output files produced by clam commands.</p>
<h2 id="zarr-format-overview">Zarr Format Overview</h2>
<p>clam uses <a href="https://zarr.dev/">Zarr</a> for its intermediate and output files. Zarr is a format for storing chunked, compressed N-dimensional arrays. Zarr enables better compression for storing multisample per-base values (depth in this case) than. Please see this <a href="https://github.com/cademirch/clam/tree/486827890a54585545e208f895211d237e896c7d/benches">small benchmark</a> for a comparison. </p>
<div class="admonition warning">
<p class="admonition-title">Schema Stability</p>
<p>The Zarr schema (metadata structure, array layout) is not yet stable and may change in future versions of clam. If you are building tools that read clam's Zarr outputs, please reach out via Github issue with any feedback and/or your use case(s).  </p>
</div>
<h3 id="depth-zarr-store">Depth Zarr Store</h3>
<p><code>clam collect</code> produces a Zarr store containing raw depth values for all samples.</p>
<p><strong>Structure:</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>depths.zarr/
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>├── zarr.json           # Zarr v3 metadata
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>├── chr1/               # Per-chromosome arrays
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>│   └── ...
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>├── chr2/
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>│   └── ...
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>└── ...
</span></code></pre></div>
<p><strong>Root Metadata (<code>clam_metadata</code>):</strong></p>
<div class="language-json highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="p">{</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="w">  </span><span class="nt">&quot;contigs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="w">    </span><span class="p">{</span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;chr1&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;length&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">248956422</span><span class="p">},</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="w">    </span><span class="p">{</span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;chr2&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;length&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">242193529</span><span class="p">}</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="w">  </span><span class="p">],</span>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="w">  </span><span class="nt">&quot;column_names&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;sample1&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;sample2&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;sample3&quot;</span><span class="p">],</span>
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="w">  </span><span class="nt">&quot;chunk_size&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1000000</span><span class="p">,</span>
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a><span class="w">  </span><span class="nt">&quot;populations&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a><span class="w">    </span><span class="p">{</span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;PopA&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;samples&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;sample1&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;sample2&quot;</span><span class="p">]},</span>
</span><span id="__span-1-10"><a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a><span class="w">    </span><span class="p">{</span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;PopB&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;samples&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;sample3&quot;</span><span class="p">]}</span>
</span><span id="__span-1-11"><a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a><span class="w">  </span><span class="p">]</span>
</span><span id="__span-1-12"><a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a><span class="p">}</span>
</span></code></pre></div>
<table>
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>contigs</code></td>
<td>array</td>
<td>List of chromosomes with names and lengths</td>
</tr>
<tr>
<td><code>column_names</code></td>
<td>array</td>
<td>Sample names in column order</td>
</tr>
<tr>
<td><code>chunk_size</code></td>
<td>integer</td>
<td>Chunk size in base pairs</td>
</tr>
<tr>
<td><code>populations</code></td>
<td>array</td>
<td>Population definitions with sample membership (present when populations were specified during <code>collect</code>)</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code>populations</code> field is present when populations were defined via <code>--samples</code> or <code>--population-file</code> during the <code>collect</code> step. This metadata is automatically read by <code>clam loci</code> when the zarr store is used as input.</p>
</div>
<p><strong>Array Properties:</strong></p>
<table>
<thead>
<tr>
<th>Property</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Data type</td>
<td><code>uint32</code></td>
</tr>
<tr>
<td>Shape</td>
<td><code>(chromosome_length, num_samples)</code></td>
</tr>
<tr>
<td>Chunk shape</td>
<td><code>(chunk_size, num_samples)</code></td>
</tr>
<tr>
<td>Compression</td>
<td>Blosc (Zstd, level 5, byte shuffle)</td>
</tr>
</tbody>
</table>
<p><strong>Per-Chromosome Metadata (<code>contig_info</code>):</strong></p>
<div class="language-json highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="p">{</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="w">  </span><span class="nt">&quot;contig&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;chr1&quot;</span><span class="p">,</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="w">  </span><span class="nt">&quot;length&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">248956422</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="p">}</span>
</span></code></pre></div>
<hr />
<h2 id="clam-loci-output">clam loci Output</h2>
<h3 id="callable-sites-zarr-store-default">Callable Sites Zarr Store (default)</h3>
<p>By default, <code>clam loci</code> produces a Zarr store containing callable sample counts per population.</p>
<p><strong>Structure:</strong> Same as depth Zarr (see above).</p>
<p><strong>Root Metadata (<code>clam_metadata</code>):</strong></p>
<div class="language-json highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="p">{</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="w">  </span><span class="nt">&quot;contigs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="w">    </span><span class="p">{</span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;chr1&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;length&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">248956422</span><span class="p">},</span>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="w">    </span><span class="p">{</span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;chr2&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;length&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">242193529</span><span class="p">}</span>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="w">  </span><span class="p">],</span>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="w">  </span><span class="nt">&quot;column_names&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;PopA&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;PopB&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;PopC&quot;</span><span class="p">],</span>
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a><span class="w">  </span><span class="nt">&quot;chunk_size&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1000000</span><span class="p">,</span>
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a><span class="w">  </span><span class="nt">&quot;callable_loci_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;population_counts&quot;</span><span class="p">,</span>
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a><span class="w">  </span><span class="nt">&quot;populations&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-3-10"><a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a><span class="w">    </span><span class="p">{</span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;PopA&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;samples&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;sample1&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;sample2&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;sample3&quot;</span><span class="p">]},</span>
</span><span id="__span-3-11"><a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a><span class="w">    </span><span class="p">{</span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;PopB&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;samples&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;sample4&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;sample5&quot;</span><span class="p">]},</span>
</span><span id="__span-3-12"><a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a><span class="w">    </span><span class="p">{</span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;PopC&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;samples&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;sample6&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;sample7&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;sample8&quot;</span><span class="p">]}</span>
</span><span id="__span-3-13"><a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a><span class="w">  </span><span class="p">]</span>
</span><span id="__span-3-14"><a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a><span class="p">}</span>
</span></code></pre></div>
<table>
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>contigs</code></td>
<td>array</td>
<td>List of chromosomes with names and lengths</td>
</tr>
<tr>
<td><code>column_names</code></td>
<td>array</td>
<td>Population names in column order</td>
</tr>
<tr>
<td><code>chunk_size</code></td>
<td>integer</td>
<td>Chunk size in base pairs</td>
</tr>
<tr>
<td><code>callable_loci_type</code></td>
<td>string</td>
<td>Type of callable loci data (<code>population_counts</code>)</td>
</tr>
<tr>
<td><code>populations</code></td>
<td>array</td>
<td>Population definitions with sample membership (see below)</td>
</tr>
</tbody>
</table>
<p><strong>Population metadata:</strong></p>
<table>
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>name</code></td>
<td>string</td>
<td>Population name</td>
</tr>
<tr>
<td><code>samples</code></td>
<td>array</td>
<td>List of sample names in this population</td>
</tr>
</tbody>
</table>
<p><strong>Array Properties:</strong></p>
<table>
<thead>
<tr>
<th>Property</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Data type</td>
<td><code>uint16</code></td>
</tr>
<tr>
<td>Shape</td>
<td><code>(chromosome_length, num_populations)</code></td>
</tr>
<tr>
<td>Chunk shape</td>
<td><code>(chunk_size, num_populations)</code></td>
</tr>
<tr>
<td>Compression</td>
<td>Blosc (Zstd, level 5, byte shuffle)</td>
</tr>
</tbody>
</table>
<p><strong>Data interpretation:</strong></p>
<p>Each value represents the number of samples in that population that are callable at that position. For example, if <code>PopA</code> has 10 samples and the value at position 1000 is 8, then 8 of the 10 samples in <code>PopA</code> are callable at position 1000.</p>
<h3 id="per-sample-mask-zarr-store-per-sample">Per-Sample Mask Zarr Store (<code>--per-sample</code>)</h3>
<p>When using <code>--per-sample</code>, <code>clam loci</code> outputs a boolean mask indicating callability for each sample.</p>
<p><strong>Root Metadata (<code>clam_metadata</code>):</strong></p>
<div class="language-json highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="p">{</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="w">  </span><span class="nt">&quot;contigs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="w">    </span><span class="p">{</span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;chr1&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;length&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">248956422</span><span class="p">}</span>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="w">  </span><span class="p">],</span>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="w">  </span><span class="nt">&quot;column_names&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;sample1&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;sample2&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;sample3&quot;</span><span class="p">],</span>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a><span class="w">  </span><span class="nt">&quot;chunk_size&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1000000</span><span class="p">,</span>
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a><span class="w">  </span><span class="nt">&quot;callable_loci_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;sample_masks&quot;</span><span class="p">,</span>
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a><span class="w">  </span><span class="nt">&quot;populations&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a><span class="w">    </span><span class="p">{</span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;PopA&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;samples&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;sample1&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;sample2&quot;</span><span class="p">]},</span>
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a><span class="w">    </span><span class="p">{</span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;PopB&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;samples&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;sample3&quot;</span><span class="p">]}</span>
</span><span id="__span-4-11"><a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a><span class="w">  </span><span class="p">]</span>
</span><span id="__span-4-12"><a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a><span class="p">}</span>
</span></code></pre></div>
<table>
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>contigs</code></td>
<td>array</td>
<td>List of chromosomes with names and lengths</td>
</tr>
<tr>
<td><code>column_names</code></td>
<td>array</td>
<td>Sample names in column order</td>
</tr>
<tr>
<td><code>chunk_size</code></td>
<td>integer</td>
<td>Chunk size in base pairs</td>
</tr>
<tr>
<td><code>callable_loci_type</code></td>
<td>string</td>
<td>Type of callable loci data (<code>sample_masks</code>)</td>
</tr>
<tr>
<td><code>populations</code></td>
<td>array</td>
<td>Population definitions with sample membership</td>
</tr>
</tbody>
</table>
<p><strong>Array Properties:</strong></p>
<table>
<thead>
<tr>
<th>Property</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Data type</td>
<td><code>bool</code></td>
</tr>
<tr>
<td>Shape</td>
<td><code>(chromosome_length, num_samples)</code></td>
</tr>
<tr>
<td>Chunk shape</td>
<td><code>(chunk_size, num_samples)</code></td>
</tr>
<tr>
<td>Compression</td>
<td>PackBits</td>
</tr>
</tbody>
</table>
<p><strong>Data interpretation:</strong></p>
<ul>
<li><code>true</code>: Site is callable for this sample</li>
<li><code>false</code>: Site is not callable for this sample</li>
</ul>
<hr />
<h2 id="clam-stat-output">clam stat Output</h2>
<p><code>clam stat</code> produces tab-separated (TSV) files in the specified output directory.</p>
<h3 id="pitsv">pi.tsv</h3>
<p>Nucleotide diversity (π) per population per window.</p>
<p><strong>Always generated.</strong></p>
<table>
<thead>
<tr>
<th>Column</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>chrom</code></td>
<td>string</td>
<td>Chromosome name</td>
</tr>
<tr>
<td><code>start</code></td>
<td>integer</td>
<td>Window start position (1-based)</td>
</tr>
<tr>
<td><code>end</code></td>
<td>integer</td>
<td>Window end position (1-based, inclusive)</td>
</tr>
<tr>
<td><code>population</code></td>
<td>string</td>
<td>Population name</td>
</tr>
<tr>
<td><code>pi</code></td>
<td>float</td>
<td>Nucleotide diversity estimate</td>
</tr>
<tr>
<td><code>comparisons</code></td>
<td>integer</td>
<td>Total pairwise comparisons (denominator)</td>
</tr>
<tr>
<td><code>differences</code></td>
<td>integer</td>
<td>Pairwise differences observed (numerator)</td>
</tr>
</tbody>
</table>
<p><strong>Example:</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>chrom   start   end population  pi  comparisons differences
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>chr1    1   10000   PopA    0.00234 4500000 10530
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>chr1    1   10000   PopB    0.00198 3800000 7524
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a>chr1    10001   20000   PopA    0.00241 4600000 11086
</span></code></pre></div>
<p><strong>Notes:</strong></p>
<ul>
<li><code>pi = differences / comparisons</code></li>
<li><code>comparisons</code> includes both variant and invariant callable sites</li>
<li><code>NaN</code> indicates no valid comparisons in the window</li>
</ul>
<h3 id="dxytsv">dxy.tsv</h3>
<p>Absolute divergence (d<sub>xy</sub>) between population pairs.</p>
<p><strong>Generated only when &gt;1 population is defined.</strong></p>
<table>
<thead>
<tr>
<th>Column</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>chrom</code></td>
<td>string</td>
<td>Chromosome name</td>
</tr>
<tr>
<td><code>start</code></td>
<td>integer</td>
<td>Window start position (1-based)</td>
</tr>
<tr>
<td><code>end</code></td>
<td>integer</td>
<td>Window end position (1-based, inclusive)</td>
</tr>
<tr>
<td><code>population1</code></td>
<td>string</td>
<td>First population name</td>
</tr>
<tr>
<td><code>population2</code></td>
<td>string</td>
<td>Second population name</td>
</tr>
<tr>
<td><code>dxy</code></td>
<td>float</td>
<td>Absolute divergence estimate</td>
</tr>
<tr>
<td><code>comparisons</code></td>
<td>integer</td>
<td>Total between-population comparisons</td>
</tr>
<tr>
<td><code>differences</code></td>
<td>integer</td>
<td>Between-population differences</td>
</tr>
</tbody>
</table>
<p><strong>Example:</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>chrom   start   end population1 population2 dxy comparisons differences
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>chr1    1   10000   PopA    PopB    0.00312 8500000 26520
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>chr1    1   10000   PopA    PopC    0.00287 7200000 20664
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>chr1    1   10000   PopB    PopC    0.00301 6800000 20468
</span></code></pre></div>
<p><strong>Notes:</strong></p>
<ul>
<li>One row per population pair per window</li>
<li>Population pairs are unordered (<code>PopA-PopB</code> is the same as <code>PopB-PopA</code>)</li>
<li><code>dxy = differences / comparisons</code></li>
</ul>
<h3 id="fsttsv">fst.tsv</h3>
<p>Fixation index (F<sub>ST</sub>) between population pairs.</p>
<p><strong>Generated only when &gt;1 population is defined.</strong></p>
<table>
<thead>
<tr>
<th>Column</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>chrom</code></td>
<td>string</td>
<td>Chromosome name</td>
</tr>
<tr>
<td><code>start</code></td>
<td>integer</td>
<td>Window start position (1-based)</td>
</tr>
<tr>
<td><code>end</code></td>
<td>integer</td>
<td>Window end position (1-based, inclusive)</td>
</tr>
<tr>
<td><code>population1</code></td>
<td>string</td>
<td>First population name</td>
</tr>
<tr>
<td><code>population2</code></td>
<td>string</td>
<td>Second population name</td>
</tr>
<tr>
<td><code>fst</code></td>
<td>float</td>
<td>F<sub>ST</sub> estimate (Hudson estimator)</td>
</tr>
</tbody>
</table>
<p><strong>Example:</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>chrom   start   end population1 population2 fst
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>chr1    1   10000   PopA    PopB    0.156
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>chr1    1   10000   PopA    PopC    0.089
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a>chr1    1   10000   PopB    PopC    0.201
</span></code></pre></div>
<p><strong>Notes:</strong></p>
<ul>
<li>F<sub>ST</sub> is calculated using the Hudson estimator: F<sub>ST</sub> = (d<sub>xy</sub> - π<sub>avg</sub>) / d<sub>xy</sub></li>
<li>Values range from 0 (no differentiation) to 1 (complete differentiation)</li>
<li>Negative values can occur when within-population diversity exceeds between-population divergence</li>
<li><code>NaN</code> indicates undefined F<sub>ST</sub> (e.g., no polymorphic sites)</li>
</ul>
<h3 id="heterozygositytsv">heterozygosity.tsv</h3>
<p>Per-sample or per-population heterozygosity.</p>
<p><strong>Generated only when callable sites are provided.</strong></p>
<table>
<thead>
<tr>
<th>Column</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>chrom</code></td>
<td>string</td>
<td>Chromosome name</td>
</tr>
<tr>
<td><code>start</code></td>
<td>integer</td>
<td>Window start position (1-based)</td>
</tr>
<tr>
<td><code>end</code></td>
<td>integer</td>
<td>Window end position (1-based, inclusive)</td>
</tr>
<tr>
<td><code>sample</code></td>
<td>string</td>
<td>Sample name (only in per-sample mode)</td>
</tr>
<tr>
<td><code>population</code></td>
<td>string</td>
<td>Population name</td>
</tr>
<tr>
<td><code>het_total</code></td>
<td>integer</td>
<td>Number of heterozygous sites</td>
</tr>
<tr>
<td><code>callable_total</code></td>
<td>integer</td>
<td>Number of callable sites</td>
</tr>
<tr>
<td><code>heterozygosity</code></td>
<td>float</td>
<td>Heterozygosity rate (het_total / callable_total)</td>
</tr>
<tr>
<td><code>het_not_in_roh</code></td>
<td>integer</td>
<td>Het sites excluding ROH (if <code>--roh</code> provided)</td>
</tr>
<tr>
<td><code>callable_not_in_roh</code></td>
<td>integer</td>
<td>Callable sites excluding ROH (if <code>--roh</code> provided)</td>
</tr>
<tr>
<td><code>heterozygosity_not_in_roh</code></td>
<td>float</td>
<td>Heterozygosity excluding ROH (if <code>--roh</code> provided)</td>
</tr>
</tbody>
</table>
<p><strong>Example (per-sample mode):</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>chrom   start   end sample  population  het_total   callable_total  heterozygosity  het_not_in_roh  callable_not_in_roh heterozygosity_not_in_roh
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>chr1    1   10000   sample1 PopA    234 9500    0.0246  220 9000    0.0244
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a>chr1    1   10000   sample2 PopA    198 9200    0.0215  198 9200    0.0215
</span></code></pre></div>
<p><strong>Example (per-population mode):</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>chrom   start   end population  het_total   callable_total  heterozygosity  het_not_in_roh  callable_not_in_roh heterozygosity_not_in_roh
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>chr1    1   10000   PopA    1856    94500   0.0196  1750    89000   0.0197
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>chr1    1   10000   PopB    2134    96000   0.0222  2134    96000   0.0222
</span></code></pre></div>
<p><strong>Notes:</strong></p>
<ul>
<li>Per-sample mode is used when callable sites were generated with <code>--per-sample</code> in <code>clam loci</code></li>
<li>Per-population mode is used when callable sites contain population counts (default <code>clam loci</code> output)</li>
</ul>
<hr />
<h2 id="output-summary">Output Summary</h2>
<table>
<thead>
<tr>
<th>Command</th>
<th>Output</th>
<th>Format</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>collect</code></td>
<td><code>*.zarr/</code></td>
<td>Zarr</td>
<td>Raw depth values (uint32)</td>
</tr>
<tr>
<td><code>loci</code></td>
<td><code>*.zarr/</code></td>
<td>Zarr</td>
<td>Callable counts (uint16) or masks (bool)</td>
</tr>
<tr>
<td><code>stat</code></td>
<td><code>pi.tsv</code></td>
<td>TSV</td>
<td>Nucleotide diversity</td>
</tr>
<tr>
<td><code>stat</code></td>
<td><code>dxy.tsv</code></td>
<td>TSV</td>
<td>Absolute divergence (if &gt;1 pop)</td>
</tr>
<tr>
<td><code>stat</code></td>
<td><code>fst.tsv</code></td>
<td>TSV</td>
<td>Fixation index (if &gt;1 pop)</td>
</tr>
<tr>
<td><code>stat</code></td>
<td><code>heterozygosity.tsv</code></td>
<td>TSV</td>
<td>Heterozygosity (if callable sites provided)</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="working-with-outputs">Working with Outputs</h2>
<h3 id="reading-zarr-in-python">Reading Zarr in Python</h3>
<div class="language-python highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">zarr</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="c1"># Open store</span>
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a><span class="n">store</span> <span class="o">=</span> <span class="n">zarr</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;callable.zarr&quot;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a>
</span><span id="__span-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a><span class="c1"># Get metadata</span>
</span><span id="__span-10-7"><a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a><span class="n">meta</span> <span class="o">=</span> <span class="n">store</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;clam_metadata&quot;</span><span class="p">]</span>
</span><span id="__span-10-8"><a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a><span class="n">populations</span> <span class="o">=</span> <span class="n">meta</span><span class="p">[</span><span class="s2">&quot;column_names&quot;</span><span class="p">]</span>
</span><span id="__span-10-9"><a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a><span class="n">chunk_size</span> <span class="o">=</span> <span class="n">meta</span><span class="p">[</span><span class="s2">&quot;chunk_size&quot;</span><span class="p">]</span>
</span><span id="__span-10-10"><a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a>
</span><span id="__span-10-11"><a id="__codelineno-10-11" name="__codelineno-10-11" href="#__codelineno-10-11"></a><span class="c1"># Read chromosome data</span>
</span><span id="__span-10-12"><a id="__codelineno-10-12" name="__codelineno-10-12" href="#__codelineno-10-12"></a><span class="n">chr1</span> <span class="o">=</span> <span class="n">store</span><span class="p">[</span><span class="s2">&quot;chr1&quot;</span><span class="p">][:]</span>  <span class="c1"># Shape: (chrom_length, num_populations)</span>
</span><span id="__span-10-13"><a id="__codelineno-10-13" name="__codelineno-10-13" href="#__codelineno-10-13"></a>
</span><span id="__span-10-14"><a id="__codelineno-10-14" name="__codelineno-10-14" href="#__codelineno-10-14"></a><span class="c1"># Read specific region (efficient)</span>
</span><span id="__span-10-15"><a id="__codelineno-10-15" name="__codelineno-10-15" href="#__codelineno-10-15"></a><span class="n">region</span> <span class="o">=</span> <span class="n">store</span><span class="p">[</span><span class="s2">&quot;chr1&quot;</span><span class="p">][</span><span class="mi">1000000</span><span class="p">:</span><span class="mi">2000000</span><span class="p">,</span> <span class="p">:]</span>
</span></code></pre></div>
<p>For more detailed examples of working with Zarr outputs, including exploring depth distributions, see the <a href="https://github.com/cademirch/clam/tree/main/notebooks">example notebooks</a> (coming soon).</p>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../input-formats/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Input Formats">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Input Formats
              </div>
            </div>
          </a>
        
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["toc.follow", "content.action.edit", "navigation.footer", "navigation.sections"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>